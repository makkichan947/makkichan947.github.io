<!doctype html>
<html lang="zh">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>ä¸´æ—¶å·¥å…·é“¾æµ‹è¯• // Yaku Makki</title>
    <link rel="shortcut icon" href="./avatar.jpg" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.151.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Yaku Makki" />
    <meta name="description" content="éªŒè¯ä¸´æ—¶å·¥å…·é“¾çš„å®Œæ•´æ€§å’ŒåŠŸèƒ½" />
    <link rel="stylesheet" href="/css/main.min.422840b4454cb211f5b3dab61f082cdff508e88825173c31806835cb75529734.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•">
  <meta name="twitter:description" content="éªŒè¯ä¸´æ—¶å·¥å…·é“¾çš„å®Œæ•´æ€§å’ŒåŠŸèƒ½">

    <meta property="og:url" content="http://localhost:1313/wiki/lfs/toolchain/testing/">
  <meta property="og:site_name" content="Yaku Makki">
  <meta property="og:title" content="ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•">
  <meta property="og:description" content="éªŒè¯ä¸´æ—¶å·¥å…·é“¾çš„å®Œæ•´æ€§å’ŒåŠŸèƒ½">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="wiki">
    <meta property="article:published_time" content="2025-10-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-28T00:00:00+00:00">


  </head>
  <body class="synthwave-bg">
    <header class="app-header glass-morphism neon-border">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Yaku Makki" /></a>
      <span class="app-header-title gradient-text">Yaku Makki</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">é¦–é¡µ</a>
             | 
          
          <a class="app-header-menu-item" href="/post/">åšå®¢</a>
             | 
          
          <a class="app-header-menu-item" href="/wiki/">ç»´åŸº</a>
             | 
          
          <a class="app-header-menu-item" href="/tags/">æ ‡ç­¾</a>
             | 
          
          <a class="app-header-menu-item" href="/about/">å…³äº</a>
      </nav>
      <p>ä¸ªäººå°å·¢</p>
      <div class="app-header-social">
        
          <a href="https://github.com/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="mailto:yakumakki947@hotmail.com" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-mail" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>mail</title><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          </a>
        
          <a href="https://x.com/Makki_Yaku947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
          </a>
        
          <a href="https://www.twitch.tv/u/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-twitch" viewBox="0 0 24 24" fill="currentColor"><title>Twitch</title><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container glass-morphism glow-effect">
      <div class="floating-particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 6s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 7s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 8s;"></div>
      </div>
      
  <article class="post enhanced-card glow-effect">
    <header class="post-header">
      <h1 class ="post-title gradient-text">ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Oct 28, 2025
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          8 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•">ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•</h1>
<p>æ„å»ºå®Œæˆåï¼Œå¿…é¡»å¯¹ä¸´æ—¶å·¥å…·é“¾è¿›è¡Œå…¨é¢æµ‹è¯•ï¼Œç¡®ä¿å…¶èƒ½å¤Ÿæ­£ç¡®ç¼–è¯‘å’Œè¿è¡Œç¨‹åºã€‚æœ¬ç« å°†ä»‹ç»å„ç§æµ‹è¯•æ–¹æ³•å’ŒéªŒè¯æ­¥éª¤ã€‚</p>
<h2 id="-æµ‹è¯•ç›®æ ‡">ğŸ¯ æµ‹è¯•ç›®æ ‡</h2>
<h3 id="å·¥å…·é“¾éªŒè¯å†…å®¹">å·¥å…·é“¾éªŒè¯å†…å®¹</h3>
<p>ä¸´æ—¶å·¥å…·é“¾æµ‹è¯•éœ€è¦éªŒè¯ï¼š</p>
<ol>
<li><strong>ç¼–è¯‘å™¨åŠŸèƒ½</strong>ï¼šGCCèƒ½å¤Ÿæ­£ç¡®ç¼–è¯‘C/C++ç¨‹åº</li>
<li><strong>é“¾æ¥å™¨åŠŸèƒ½</strong>ï¼šèƒ½å¤Ÿæ­£ç¡®é“¾æ¥ç›®æ ‡æ–‡ä»¶å’Œåº“</li>
<li><strong>åº“åŠŸèƒ½</strong>ï¼šCåº“å’Œè¿è¡Œæ—¶æ”¯æŒæ­£å¸¸å·¥ä½œ</li>
<li><strong>äº¤å‰ç¼–è¯‘</strong>ï¼šèƒ½å¤Ÿç”Ÿæˆç›®æ ‡å¹³å°çš„å¯æ‰§è¡Œä»£ç </li>
<li><strong>è°ƒè¯•æ”¯æŒ</strong>ï¼šè°ƒè¯•ä¿¡æ¯å’Œç¬¦å·è¡¨æ­£ç¡®</li>
</ol>
<h2 id="-åŸºæœ¬åŠŸèƒ½æµ‹è¯•">ğŸ§ª åŸºæœ¬åŠŸèƒ½æµ‹è¯•</h2>
<h3 id="ç¼–è¯‘å™¨æµ‹è¯•">ç¼–è¯‘å™¨æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># åˆ‡æ¢åˆ°lfsç”¨æˆ·</span>
</span></span><span style="display:flex;"><span>su - lfs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºæµ‹è¯•ç›®å½•</span>
</span></span><span style="display:flex;"><span>mkdir -pv $LFS/toolchain_tests
</span></span><span style="display:flex;"><span>cd $LFS/toolchain_tests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŸºæœ¬Cç¨‹åºæµ‹è¯•</span>
</span></span><span style="display:flex;"><span>cat &gt; hello.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">(</span>int argc, char *argv<span style="color:#f92672">[])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello, LFS Toolchain!\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>argc &gt; 1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Arguments: &#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 1; i &lt; argc; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%s &#34;</span>, argv<span style="color:#f92672">[</span>i<span style="color:#f92672">])</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> EXIT_SUCCESS;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc hello.c -o hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥ç¼–è¯‘ç»“æœ</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x hello <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ åŸºæœ¬ç¼–è¯‘æµ‹è¯•é€šè¿‡&#34;</span>
</span></span><span style="display:flex;"><span>    $LFS_TGT-readelf -l hello | grep <span style="color:#e6db74">&#34;interpreter&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— åŸºæœ¬ç¼–è¯‘æµ‹è¯•å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="åº“åŠŸèƒ½æµ‹è¯•">åº“åŠŸèƒ½æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•æ ‡å‡†åº“å‡½æ•°</span>
</span></span><span style="display:flex;"><span>cat &gt; lib_test.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;string.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;math.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;time.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== æ ‡å‡†åº“åŠŸèƒ½æµ‹è¯• ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // å­—ç¬¦ä¸²å‡½æ•°
</span></span><span style="display:flex;"><span>    char str1<span style="color:#f92672">[</span>50<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello&#34;</span>;
</span></span><span style="display:flex;"><span>    char str2<span style="color:#f92672">[</span>50<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;World&#34;</span>;
</span></span><span style="display:flex;"><span>    strcat<span style="color:#f92672">(</span>str1, <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    strcat<span style="color:#f92672">(</span>str1, str2<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å­—ç¬¦ä¸²è¿æ¥: %s\n&#34;</span>, str1<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ•°å­¦å‡½æ•°
</span></span><span style="display:flex;"><span>    double x <span style="color:#f92672">=</span> 3.14159;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å¹³æ–¹æ ¹: %.6f\n&#34;</span>, sqrt<span style="color:#f92672">(</span>x<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;æ­£å¼¦å€¼: %.6f\n&#34;</span>, sin<span style="color:#f92672">(</span>x<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // å†…å­˜ç®¡ç†
</span></span><span style="display:flex;"><span>    int *array <span style="color:#f92672">=</span> malloc<span style="color:#f92672">(</span><span style="color:#ae81ff">10</span> * sizeof<span style="color:#f92672">(</span>int<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>array<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; 10; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> i * i;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;æ•°ç»„å†…å®¹: &#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; 10; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%d &#34;</span>, array<span style="color:#f92672">[</span>i<span style="color:#f92672">])</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        free<span style="color:#f92672">(</span>array<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;âœ“ å†…å­˜ç®¡ç†æµ‹è¯•é€šè¿‡\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;âœ— å†…å­˜åˆ†é…å¤±è´¥\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ—¶é—´å‡½æ•°
</span></span><span style="display:flex;"><span>    time_t now <span style="color:#f92672">=</span> time<span style="color:#f92672">(</span>NULL<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å½“å‰æ—¶é—´æˆ³: %ld\n&#34;</span>, now<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== æ‰€æœ‰æµ‹è¯•å®Œæˆ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘å¹¶æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc lib_test.c -lm -o lib_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x lib_test <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ åº“åŠŸèƒ½æµ‹è¯•ç¼–è¯‘æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— åº“åŠŸèƒ½æµ‹è¯•ç¼–è¯‘å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="cåŠŸèƒ½æµ‹è¯•">C++åŠŸèƒ½æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># C++æ ‡å‡†åº“æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>cat &gt; cpp_test.cpp &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;iostream&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;string&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;vector&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;algorithm&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>class TestClass <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>private:
</span></span><span style="display:flex;"><span>    std::string name;
</span></span><span style="display:flex;"><span>    int value;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>public:
</span></span><span style="display:flex;"><span>    TestClass<span style="color:#f92672">(</span>std::string n, int v<span style="color:#f92672">)</span> : name<span style="color:#f92672">(</span>n<span style="color:#f92672">)</span>, value<span style="color:#f92672">(</span>v<span style="color:#f92672">)</span> <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    void display<span style="color:#f92672">()</span> const <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        std::cout &lt;&lt; <span style="color:#e6db74">&#34;å¯¹è±¡: &#34;</span> <span style="color:#e6db74">&lt;&lt; name &lt;&lt; &#34;, å€¼: &#34; &lt;&lt; value &lt;&lt; std::en</span>dl;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    int getValue<span style="color:#f92672">()</span> const <span style="color:#f92672">{</span> <span style="color:#66d9ef">return</span> value; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    std::cout &lt;&lt; <span style="color:#e6db74">&#34;=== C++åŠŸèƒ½æµ‹è¯• ===&#34;</span> <span style="color:#e6db74">&lt;&lt; std::endl;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // åŸºæœ¬è¾“å‡º
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    std</span>::cout &lt;&lt; <span style="color:#e6db74">&#34;Hello, C++!&#34;</span> <span style="color:#e6db74">&lt;&lt; std::endl;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // STLå®¹å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    std</span>::vector&lt;TestClass&gt; objects;
</span></span><span style="display:flex;"><span>    objects.emplace_back<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å¯¹è±¡1&#34;</span>, 10<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    objects.emplace_back<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å¯¹è±¡2&#34;</span>, 20<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    objects.emplace_back<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å¯¹è±¡3&#34;</span>, 15<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ’åº
</span></span><span style="display:flex;"><span>    std::sort<span style="color:#f92672">(</span>objects.begin<span style="color:#f92672">()</span>, objects.end<span style="color:#f92672">()</span>,
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">[](</span>const TestClass&amp; a, const TestClass&amp; b<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#66d9ef">return</span> a.getValue<span style="color:#f92672">()</span> &lt; b.getValue<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">})</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ˜¾ç¤ºç»“æœ
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>const auto&amp; obj : objects<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        obj.display<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std::cout &lt;&lt; <span style="color:#e6db74">&#34;=== C++æµ‹è¯•å®Œæˆ ===&#34;</span> <span style="color:#e6db74">&lt;&lt; std::endl;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return 0;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># ç¼–è¯‘C++ç¨‹åº
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$LFS_TGT-g++ cpp_test</span>.cpp -o cpp_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x cpp_test <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ C++åŠŸèƒ½æµ‹è¯•ç¼–è¯‘æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— C++åŠŸèƒ½æµ‹è¯•ç¼–è¯‘å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h2 id="-é«˜çº§åŠŸèƒ½æµ‹è¯•">ğŸ”§ é«˜çº§åŠŸèƒ½æµ‹è¯•</h2>
<h3 id="é“¾æ¥å™¨æµ‹è¯•">é“¾æ¥å™¨æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•é™æ€é“¾æ¥</span>
</span></span><span style="display:flex;"><span>cat &gt; static_lib.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void print_message<span style="color:#f92672">(</span>const char *msg<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;é™æ€åº“æ¶ˆæ¯: %s\n&#34;</span>, msg<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -c static_lib.c -o static_lib.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºé™æ€åº“</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-ar rcs libstatic.a static_lib.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä½¿ç”¨é™æ€åº“çš„ç¨‹åº</span>
</span></span><span style="display:flex;"><span>cat &gt; use_static.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void print_message<span style="color:#f92672">(</span>const char *msg<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== é™æ€é“¾æ¥æµ‹è¯• ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    print_message<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello from static library!&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== æµ‹è¯•å®Œæˆ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é™æ€é“¾æ¥</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc use_static.c -L. -lstatic -o use_static
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x use_static <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ é™æ€é“¾æ¥æµ‹è¯•æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ£€æŸ¥æ˜¯å¦åŒ…å«åº“ä»£ç </span>
</span></span><span style="display:flex;"><span>    $LFS_TGT-nm use_static | grep <span style="color:#e6db74">&#34;print_message&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— é™æ€é“¾æ¥æµ‹è¯•å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="åŠ¨æ€é“¾æ¥æµ‹è¯•">åŠ¨æ€é“¾æ¥æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•åŠ¨æ€é“¾æ¥</span>
</span></span><span style="display:flex;"><span>cat &gt; dynamic_lib.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void dynamic_function<span style="color:#f92672">(</span>const char *msg<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;åŠ¨æ€åº“æ¶ˆæ¯: %s\n&#34;</span>, msg<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘ä¸ºä½ç½®æ— å…³ä»£ç </span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -fPIC -c dynamic_lib.c -o dynamic_lib.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå…±äº«åº“</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -shared -o libdynamic.so dynamic_lib.o
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä½¿ç”¨åŠ¨æ€åº“çš„ç¨‹åº</span>
</span></span><span style="display:flex;"><span>cat &gt; use_dynamic.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void dynamic_function<span style="color:#f92672">(</span>const char *msg<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== åŠ¨æ€é“¾æ¥æµ‹è¯• ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    dynamic_function<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello from shared library!&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== æµ‹è¯•å®Œæˆ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ¨æ€é“¾æ¥ç¼–è¯‘</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc use_dynamic.c -L. -ldynamic -o use_dynamic
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x use_dynamic <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ åŠ¨æ€é“¾æ¥æµ‹è¯•æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ£€æŸ¥åŠ¨æ€ä¾èµ–</span>
</span></span><span style="display:flex;"><span>    $LFS_TGT-readelf -d use_dynamic | grep <span style="color:#e6db74">&#34;Shared library&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— åŠ¨æ€é“¾æ¥æµ‹è¯•å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="äº¤å‰ç¼–è¯‘éªŒè¯">äº¤å‰ç¼–è¯‘éªŒè¯</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•äº¤å‰ç¼–è¯‘åŠŸèƒ½</span>
</span></span><span style="display:flex;"><span>cat &gt; cross_test.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdint.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== äº¤å‰ç¼–è¯‘éªŒè¯ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ£€æŸ¥æ•°æ®ç±»å‹å¤§å°
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;char: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>char<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;short: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>short<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;int: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>int<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;long: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>long<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;long long: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>long long<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;pointer: %zu bytes\n&#34;</span>, sizeof<span style="color:#f92672">(</span>void*<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ£€æŸ¥å­—èŠ‚åº
</span></span><span style="display:flex;"><span>    uint32_t test <span style="color:#f92672">=</span> 0x12345678;
</span></span><span style="display:flex;"><span>    unsigned char *bytes <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>unsigned char*<span style="color:#f92672">)</span>&amp;test;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å­—èŠ‚åº: %s\n&#34;</span>, <span style="color:#f92672">(</span>bytes<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> 0x78<span style="color:#f92672">)</span> ? <span style="color:#e6db74">&#34;å°ç«¯&#34;</span> : <span style="color:#e6db74">&#34;å¤§ç«¯&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // æ£€æŸ¥ç¼–è¯‘å™¨å®šä¹‰
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifdef __GNUC__</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç¼–è¯‘å™¨: GCC %d.%d.%d\n&#34;</span>, __GNUC__, __GNUC_MINOR__, __GNUC_PATCHLEVEL__<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifdef __x86_64__</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç›®æ ‡æ¶æ„: x86_64\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== éªŒè¯å®Œæˆ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># äº¤å‰ç¼–è¯‘</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc cross_test.c -o cross_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x cross_test <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ äº¤å‰ç¼–è¯‘éªŒè¯æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># åˆ†æç›®æ ‡æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>    $LFS_TGT-readelf -h cross_test | grep <span style="color:#e6db74">&#34;Machine\|Class\|OS/ABI&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— äº¤å‰ç¼–è¯‘éªŒè¯å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h2 id="-æ€§èƒ½å’Œç¨³å®šæ€§æµ‹è¯•">ğŸ“Š æ€§èƒ½å’Œç¨³å®šæ€§æµ‹è¯•</h2>
<h3 id="ç¼–è¯‘æ€§èƒ½æµ‹è¯•">ç¼–è¯‘æ€§èƒ½æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•ç¼–è¯‘é€Ÿåº¦</span>
</span></span><span style="display:flex;"><span>cat &gt; perf_test.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define SIZE 10000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    int **matrix <span style="color:#f92672">=</span> malloc<span style="color:#f92672">(</span>SIZE * sizeof<span style="color:#f92672">(</span>int*<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; SIZE; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        matrix<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> malloc<span style="color:#f92672">(</span>SIZE * sizeof<span style="color:#f92672">(</span>int<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int j <span style="color:#f92672">=</span> 0; j &lt; SIZE; j++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            matrix<span style="color:#f92672">[</span>i<span style="color:#f92672">][</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> i + j;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    long long sum <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; SIZE; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int j <span style="color:#f92672">=</span> 0; j &lt; SIZE; j++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            sum <span style="color:#f92672">+=</span> matrix<span style="color:#f92672">[</span>i<span style="color:#f92672">][</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        free<span style="color:#f92672">(</span>matrix<span style="color:#f92672">[</span>i<span style="color:#f92672">])</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    free<span style="color:#f92672">(</span>matrix<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;çŸ©é˜µæ±‚å’Œç»“æœ: %lld\n&#34;</span>, sum<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•ä¸åŒä¼˜åŒ–çº§åˆ«</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;=== ç¼–è¯‘æ€§èƒ½æµ‹è¯• ===&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> opt in O0 O1 O2 O3; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;æµ‹è¯•ä¼˜åŒ–çº§åˆ«: -</span>$opt<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è®°å½•ç¼–è¯‘æ—¶é—´</span>
</span></span><span style="display:flex;"><span>    start_time<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>date +%s.%3N<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    $LFS_TGT-gcc -$opt perf_test.c -o perf_test_$opt
</span></span><span style="display:flex;"><span>    end_time<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>date +%s.%3N<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    compile_time<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">&#34;</span>$end_time<span style="color:#e6db74"> - </span>$start_time<span style="color:#e6db74">&#34;</span> | bc<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x perf_test_$opt <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        file_size<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ls -lh perf_test_$opt | awk <span style="color:#e6db74">&#39;{print $5}&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;âœ“ ç¼–è¯‘æˆåŠŸ - æ—¶é—´: </span><span style="color:#e6db74">${</span>compile_time<span style="color:#e6db74">}</span><span style="color:#e6db74">s, å¤§å°: </span>$file_size<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;âœ— ç¼–è¯‘å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h3 id="ç¨³å®šæ€§æµ‹è¯•">ç¨³å®šæ€§æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># å¤šè¿›ç¨‹ç¼–è¯‘æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>cat &gt; stress_test.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;sys/wait.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define NUM_PROCESSES 10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== ç¨³å®šæ€§æµ‹è¯• ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; NUM_PROCESSES; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        pid_t pid <span style="color:#f92672">=</span> fork<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>pid <span style="color:#f92672">==</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            // å­è¿›ç¨‹ï¼šæ‰§è¡Œç®€å•è®¡ç®—
</span></span><span style="display:flex;"><span>            long sum <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>long j <span style="color:#f92672">=</span> 0; j &lt; 100000; j++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                sum <span style="color:#f92672">+=</span> j;
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;è¿›ç¨‹ %d è®¡ç®—ç»“æœ: %ld\n&#34;</span>, i + 1, sum<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>            exit<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>pid &lt; 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;åˆ›å»ºè¿›ç¨‹å¤±è´¥\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> 1;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // ç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>int i <span style="color:#f92672">=</span> 0; i &lt; NUM_PROCESSES; i++<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        wait<span style="color:#f92672">(</span>NULL<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;=== ç¨³å®šæ€§æµ‹è¯•å®Œæˆ ===\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘å¹¶æµ‹è¯•</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc stress_test.c -o stress_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x stress_test <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ“ ç¨³å®šæ€§æµ‹è¯•ç¼–è¯‘æˆåŠŸ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;âœ— ç¨³å®šæ€§æµ‹è¯•ç¼–è¯‘å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h2 id="-è°ƒè¯•å’Œè¯Šæ–­">ğŸ” è°ƒè¯•å’Œè¯Šæ–­</h2>
<h3 id="ç¼–è¯‘è¿‡ç¨‹åˆ†æ">ç¼–è¯‘è¿‡ç¨‹åˆ†æ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># è¯¦ç»†ç¼–è¯‘è¿‡ç¨‹è·Ÿè¸ª</span>
</span></span><span style="display:flex;"><span>cat &gt; debug_compile.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define DEBUG_LEVEL 2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#if DEBUG_LEVEL &gt;= 1</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;è°ƒè¯•çº§åˆ« 1: åŸºæœ¬ä¿¡æ¯\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#if DEBUG_LEVEL &gt;= 2</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;è°ƒè¯•çº§åˆ« 2: è¯¦ç»†ä¿¡æ¯\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ç¨‹åºæ­£å¸¸è¿è¡Œ\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ˜¾ç¤ºé¢„å¤„ç†ç»“æœ</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;=== é¢„å¤„ç†ç»“æœ ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -E debug_compile.c | tail -20
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ˜¾ç¤ºæ±‡ç¼–ä»£ç </span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;\n=== æ±‡ç¼–ä»£ç  ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -S debug_compile.c
</span></span><span style="display:flex;"><span>cat debug_compile.s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ˜¾ç¤ºç¼–è¯‘è¯¦ç»†ä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;\n=== ç¼–è¯‘è¯¦ç»†ä¿¡æ¯ ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -v debug_compile.c -o debug_compile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ†æç›®æ ‡æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;\n=== ç›®æ ‡æ–‡ä»¶åˆ†æ ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-objdump -h debug_compile
</span></span><span style="display:flex;"><span>$LFS_TGT-objdump -d debug_compile | head -30
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¸…ç†</span>
</span></span><span style="display:flex;"><span>rm -f debug_compile.c debug_compile.s debug_compile
</span></span></code></pre></div><h3 id="é”™è¯¯è¯Šæ–­">é”™è¯¯è¯Šæ–­</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå¯èƒ½å‡ºé”™çš„ç¨‹åºæ¥æµ‹è¯•é”™è¯¯å¤„ç†</span>
</span></span><span style="display:flex;"><span>cat &gt; error_test.c &lt;&lt; <span style="color:#e6db74">&#34;EOF&#34;</span>
</span></span><span style="display:flex;"><span>// è¿™ä¸ªç¨‹åºåŒ…å«ä¸€äº›æ½œåœ¨çš„ç¼–è¯‘é—®é¢˜
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    // æœªä½¿ç”¨çš„å˜é‡
</span></span><span style="display:flex;"><span>    int unused_var <span style="color:#f92672">=</span> 42;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // ç±»å‹ä¸åŒ¹é…
</span></span><span style="display:flex;"><span>    char *str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello&#34;</span>;
</span></span><span style="display:flex;"><span>    // str<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;h&#39;</span>;  // è¿™ä¼šå¯¼è‡´æ®µé”™è¯¯
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;é”™è¯¯æµ‹è¯•ç¨‹åº\n&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;å­—ç¬¦ä¸²: %s\n&#34;</span>, str<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>EOF
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•è­¦å‘Šæ£€æµ‹</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;=== è­¦å‘Šæ£€æµ‹æµ‹è¯• ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -Wall -Wextra error_test.c -o error_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æµ‹è¯•ä¸¥æ ¼æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;\n=== ä¸¥æ ¼æ¨¡å¼æµ‹è¯• ===&#34;</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -Werror -Wall error_test.c -o error_test_strict 2&gt;&amp;<span style="color:#ae81ff">1</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;é¢„æœŸçš„ç¼–è¯‘å¤±è´¥&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¸…ç†</span>
</span></span><span style="display:flex;"><span>rm -f error_test.c error_test error_test_strict
</span></span></code></pre></div><h2 id="-å®Œæ•´æµ‹è¯•å¥—ä»¶">ğŸ“‹ å®Œæ•´æµ‹è¯•å¥—ä»¶</h2>
<h3 id="è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬">è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå®Œæ•´çš„æµ‹è¯•å¥—ä»¶</span>
</span></span><span style="display:flex;"><span>cat &gt; $LFS/toolchain_tests/run_all_tests.sh <span style="color:#e6db74">&lt;&lt; &#39;EOF&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># LFSå·¥å…·é“¾å®Œæ•´æµ‹è¯•å¥—ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">LFS=${LFS:-/mnt/lfs}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">LFS_TGT=${LFS_TGT:-x86_64-lfs-linux-gnu}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># é¢œè‰²å®šä¹‰
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RED=&#39;\033[0;31m&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">GREEN=&#39;\033[0;32m&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">YELLOW=&#39;\033[1;33m&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">NC=&#39;\033[0m&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># æµ‹è¯•è®¡æ•°å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">total_tests=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">passed_tests=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">failed_tests=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># æµ‹è¯•å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    local test_name=$1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    local test_cmd=$2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    echo -n &#34;è¿è¡Œæµ‹è¯•: $test_name... &#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    total_tests=$((total_tests + 1))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    if eval &#34;$test_cmd&#34; &gt;/dev/null 2&gt;&amp;1; then
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        echo -e &#34;${GREEN}é€šè¿‡${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        passed_tests=$((passed_tests + 1))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    else
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        echo -e &#34;${RED}å¤±è´¥${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        failed_tests=$((failed_tests + 1))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    fi
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># åˆ‡æ¢åˆ°æµ‹è¯•ç›®å½•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">cd $LFS/toolchain_tests
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;=== LFSå·¥å…·é“¾æµ‹è¯•å¥—ä»¶ ===&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;ç›®æ ‡å¹³å°: $LFS_TGT&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;æµ‹è¯•æ—¶é—´: $(date)&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># åŸºæœ¬ç¼–è¯‘æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;åŸºæœ¬Cç¼–è¯‘&#34; &#34;$LFS_TGT-gcc hello.c -o hello_test&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;C++ç¼–è¯‘&#34; &#34;$LFS_TGT-g++ cpp_test.cpp -o cpp_test_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;åº“é“¾æ¥&#34; &#34;$LFS_TGT-gcc lib_test.c -lm -o lib_test_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># é“¾æ¥å™¨æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;é™æ€é“¾æ¥&#34; &#34;$LFS_TGT-gcc use_static.c -L. -lstatic -o static_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;åŠ¨æ€é“¾æ¥&#34; &#34;$LFS_TGT-gcc use_dynamic.c -L. -ldynamic -o dynamic_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># äº¤å‰ç¼–è¯‘æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;äº¤å‰ç¼–è¯‘éªŒè¯&#34; &#34;$LFS_TGT-gcc cross_test.c -o cross_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># ä¼˜åŒ–æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;O0ä¼˜åŒ–&#34; &#34;$LFS_TGT-gcc -O0 perf_test.c -o perf_O0&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;O2ä¼˜åŒ–&#34; &#34;$LFS_TGT-gcc -O2 perf_test.c -o perf_O2&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;O3ä¼˜åŒ–&#34; &#34;$LFS_TGT-gcc -O3 perf_test.c -o perf_O3&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># ç¨³å®šæ€§æµ‹è¯•
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">run_test &#34;å¤šè¿›ç¨‹æµ‹è¯•&#34; &#34;$LFS_TGT-gcc stress_test.c -o stress_exec&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;=== æµ‹è¯•ç»“æœæ±‡æ€» ===&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;æ€»æµ‹è¯•æ•°: $total_tests&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo -e &#34;é€šè¿‡: ${GREEN}$passed_tests${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo -e &#34;å¤±è´¥: ${RED}$failed_tests${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">if [ $failed_tests -eq 0 ]; then
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    echo -e &#34;${GREEN}æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼å·¥å…·é“¾å·¥ä½œæ­£å¸¸ã€‚${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    exit 0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">else
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    echo -e &#34;${RED}æœ‰ $failed_tests ä¸ªæµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥å·¥å…·é“¾é…ç½®ã€‚${NC}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    exit 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fi
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod +x $LFS/toolchain_tests/run_all_tests.sh
</span></span></code></pre></div><h3 id="æµ‹è¯•ç»“æœåˆ†æ">æµ‹è¯•ç»“æœåˆ†æ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶</span>
</span></span><span style="display:flex;"><span>$LFS/toolchain_tests/run_all_tests.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š</span>
</span></span><span style="display:flex;"><span>cat &gt; $LFS/toolchain_tests/generate_report.sh <span style="color:#e6db74">&lt;&lt; &#39;EOF&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">LFS=${LFS:-/mnt/lfs}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;# LFSå·¥å…·é“¾æµ‹è¯•æŠ¥å‘Š&#34; &gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;ç”Ÿæˆæ—¶é—´: $(date)&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;## ç³»ç»Ÿä¿¡æ¯&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;- LFSç›®å½•: $LFS&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;- ç›®æ ‡å¹³å°: $LFS_TGT&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;- GCCç‰ˆæœ¬: $($LFS_TGT-gcc --version | head -1)&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;- Binutilsç‰ˆæœ¬: $($LFS_TGT-ld --version | head -1)&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;## æµ‹è¯•æ–‡ä»¶&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;\`\`\`bash&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ls -la $LFS/toolchain_tests/ &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;\`\`\`&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;## ç£ç›˜ä½¿ç”¨æƒ…å†µ&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;\`\`\`bash&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">df -h $LFS &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;\`\`\`&#34; &gt;&gt; $LFS/toolchain_test_report.md
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">echo &#34;æŠ¥å‘Šå·²ä¿å­˜åˆ°: $LFS/toolchain_test_report.md&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>chmod +x $LFS/toolchain_tests/generate_report.sh
</span></span><span style="display:flex;"><span>$LFS/toolchain_tests/generate_report.sh
</span></span></code></pre></div><h2 id="-æ•…éšœæ’é™¤æŒ‡å—">ğŸš¨ æ•…éšœæ’é™¤æŒ‡å—</h2>
<h3 id="å¸¸è§æµ‹è¯•å¤±è´¥åŸå› ">å¸¸è§æµ‹è¯•å¤±è´¥åŸå› </h3>
<ol>
<li>
<p><strong>ç¼–è¯‘å¤±è´¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥ç¯å¢ƒå˜é‡</span>
</span></span><span style="display:flex;"><span>echo $PATH
</span></span><span style="display:flex;"><span>echo $LFS_TGT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯å·¥å…·å­˜åœ¨</span>
</span></span><span style="display:flex;"><span>which $LFS_TGT-gcc
</span></span><span style="display:flex;"><span>ls -la $LFS/tools/bin/$LFS_TGT-gcc
</span></span></code></pre></div></li>
<li>
<p><strong>é“¾æ¥å¤±è´¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥åº“æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>find $LFS -name <span style="color:#e6db74">&#34;libc.so*&#34;</span> -type f
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥é“¾æ¥å™¨</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-ld --version
</span></span></code></pre></div></li>
<li>
<p><strong>è¿è¡Œæ—¶å¤±è´¥</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥åŠ¨æ€é“¾æ¥å™¨</span>
</span></span><span style="display:flex;"><span>ls -la $LFS/lib/ld-linux*
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯åº“ä¾èµ–</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-readelf -d <span style="color:#f92672">[</span>å¯æ‰§è¡Œæ–‡ä»¶<span style="color:#f92672">]</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="è°ƒè¯•æŠ€å·§">è°ƒè¯•æŠ€å·§</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># å¯ç”¨è¯¦ç»†è¾“å‡º</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -v hello.c -o hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ˜¾ç¤ºé¢„å¤„ç†ç»“æœ</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -E hello.c | head -50
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ˜¾ç¤ºç¼–è¯‘è­¦å‘Š</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-gcc -Wall -Wextra hello.c -o hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ†æç›®æ ‡æ–‡ä»¶</span>
</span></span><span style="display:flex;"><span>$LFS_TGT-objdump -x hello
</span></span><span style="display:flex;"><span>$LFS_TGT-readelf -a hello
</span></span></code></pre></div><h2 id="-ç›¸å…³èµ„æº">ğŸ“š ç›¸å…³èµ„æº</h2>
<ul>
<li><a href="http://www.linuxfromscratch.org/lfs/view/stable/chapter05/chapter05.html">LFSå®˜æ–¹æ–‡æ¡£ - å·¥å…·é“¾æµ‹è¯•</a></li>
<li><a href="https://gcc.gnu.org/onlinedocs/gccint/Testsuites.html">GCCæµ‹è¯•å¥—ä»¶</a></li>
<li><a href="https://sourceware.org/binutils/binutils.pdf">Binutilsæµ‹è¯•</a></li>
</ul>
<hr>
<p><em>æœ€è¿‘æ›´æ–°: {{ .Lastmod.Format &ldquo;2006-01-02&rdquo; }}</em></p>

      
      <div class="post-separator">------------------------------------------------------------------------</div>
      
    </div>
    <div class="post-footer">
      
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <div class="busuanzi-container">
        <span id="busuanzi_container_page_pv">--æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡--</span>
      </div>
      
      
      <script src="https://utteranc.es/client.js"
        repo="makkichan947/makkichan947.github.io"
        issue-term="pathname"
        label="Utterances"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
    </div>
  </article>

    </main>
  </body>
</html>
