<!doctype html>
<html lang="zh">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>ç¥ç»ç½‘ç»œåŸºç¡€ // Yaku Makki</title>
    <link rel="shortcut icon" href="./assets/avatar/avatar.jpg" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.151.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Yaku Makki" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.422840b4454cb211f5b3dab61f082cdff508e88825173c31806835cb75529734.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ç¥ç»ç½‘ç»œåŸºç¡€">
  <meta name="twitter:description" content="ç¥ç»ç½‘ç»œåŸºç¡€ ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰æ˜¯æ·±åº¦å­¦ä¹ çš„åŸºç¡€ï¼Œæ¨¡æ‹Ÿäº†äººè„‘ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ã€‚æœ¬ç« è¯¦ç»†ä»‹ç»ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µã€ç»“æ„å’Œè®­ç»ƒæ–¹æ³•ã€‚
ğŸ§  ç¥ç»å…ƒæ¨¡å‹ ç”Ÿç‰©ç¥ç»å…ƒ äººè„‘ä¸­çš„ç¥ç»å…ƒé€šè¿‡çªè§¦æ¥æ”¶å’Œå¤„ç†ä¿¡å·ï¼Œç¥ç»ç½‘ç»œä¸­çš„äººå·¥ç¥ç»å…ƒæ¨¡ä»¿äº†è¿™ä¸€è¿‡ç¨‹ã€‚
äººå·¥ç¥ç»å…ƒ äººå·¥ç¥ç»å…ƒï¼ˆArtificial Neuronï¼‰æ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒï¼š
æ•°å­¦æ¨¡å‹ï¼š $$z = \sum_{i=1}^{n} w_i x_i &#43; b$$ $$a = g(z)$$
å…¶ä¸­ï¼š
$x_i$ï¼šè¾“å…¥ç‰¹å¾ $w_i$ï¼šæƒé‡å‚æ•° $b$ï¼šåç½®é¡¹ $g(\cdot)$ï¼šæ¿€æ´»å‡½æ•° $a$ï¼šç¥ç»å…ƒè¾“å‡º ç¥ç»ç½‘ç»œç»“æ„ å•å±‚ç¥ç»ç½‘ç»œï¼š
è¾“å…¥å±‚ â†’ è¾“å‡ºå±‚ å¤šå±‚ç¥ç»ç½‘ç»œï¼š
è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ ... â†’ è¾“å‡ºå±‚ ğŸ”„ å‰å‘ä¼ æ’­ è®¡ç®—è¿‡ç¨‹ ç¬¬ä¸€å±‚ï¼š $$z^{(1)} = W^{(1)} x &#43; b^{(1)}$$ $$a^{(1)} = g^{(1)}(z^{(1)})$$
ç¬¬lå±‚ï¼š $$z^{(l)} = W^{(l)} a^{(l-1)} &#43; b^{(l)}$$ $$a^{(l)} = g^{(l)}(z^{(l)})$$
å‘é‡è¡¨ç¤º ä½¿ç”¨çŸ©é˜µè¿ç®—æé«˜æ•ˆç‡ï¼š $$Z = W \cdot A &#43; b$$ $$A = g(Z)$$">

    <meta property="og:url" content="http://localhost:1313/wiki/deep_learning/neural_networks/">
  <meta property="og:site_name" content="Yaku Makki">
  <meta property="og:title" content="ç¥ç»ç½‘ç»œåŸºç¡€">
  <meta property="og:description" content="ç¥ç»ç½‘ç»œåŸºç¡€ ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰æ˜¯æ·±åº¦å­¦ä¹ çš„åŸºç¡€ï¼Œæ¨¡æ‹Ÿäº†äººè„‘ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ã€‚æœ¬ç« è¯¦ç»†ä»‹ç»ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µã€ç»“æ„å’Œè®­ç»ƒæ–¹æ³•ã€‚
ğŸ§  ç¥ç»å…ƒæ¨¡å‹ ç”Ÿç‰©ç¥ç»å…ƒ äººè„‘ä¸­çš„ç¥ç»å…ƒé€šè¿‡çªè§¦æ¥æ”¶å’Œå¤„ç†ä¿¡å·ï¼Œç¥ç»ç½‘ç»œä¸­çš„äººå·¥ç¥ç»å…ƒæ¨¡ä»¿äº†è¿™ä¸€è¿‡ç¨‹ã€‚
äººå·¥ç¥ç»å…ƒ äººå·¥ç¥ç»å…ƒï¼ˆArtificial Neuronï¼‰æ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒï¼š
æ•°å­¦æ¨¡å‹ï¼š $$z = \sum_{i=1}^{n} w_i x_i &#43; b$$ $$a = g(z)$$
å…¶ä¸­ï¼š
$x_i$ï¼šè¾“å…¥ç‰¹å¾ $w_i$ï¼šæƒé‡å‚æ•° $b$ï¼šåç½®é¡¹ $g(\cdot)$ï¼šæ¿€æ´»å‡½æ•° $a$ï¼šç¥ç»å…ƒè¾“å‡º ç¥ç»ç½‘ç»œç»“æ„ å•å±‚ç¥ç»ç½‘ç»œï¼š
è¾“å…¥å±‚ â†’ è¾“å‡ºå±‚ å¤šå±‚ç¥ç»ç½‘ç»œï¼š
è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ ... â†’ è¾“å‡ºå±‚ ğŸ”„ å‰å‘ä¼ æ’­ è®¡ç®—è¿‡ç¨‹ ç¬¬ä¸€å±‚ï¼š $$z^{(1)} = W^{(1)} x &#43; b^{(1)}$$ $$a^{(1)} = g^{(1)}(z^{(1)})$$
ç¬¬lå±‚ï¼š $$z^{(l)} = W^{(l)} a^{(l-1)} &#43; b^{(l)}$$ $$a^{(l)} = g^{(l)}(z^{(l)})$$
å‘é‡è¡¨ç¤º ä½¿ç”¨çŸ©é˜µè¿ç®—æé«˜æ•ˆç‡ï¼š $$Z = W \cdot A &#43; b$$ $$A = g(Z)$$">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="wiki">
    <meta property="article:published_time" content="2025-10-19T20:10:09+08:00">
    <meta property="article:modified_time" content="2025-10-19T20:10:09+08:00">


  </head>
  <body class="synthwave-bg">
    <header class="app-header glass-morphism neon-border">
      <a href="/"><img class="app-header-avatar" src="/assets/avatar/avatar.jpg" alt="Yaku Makki" /></a>
      <span class="app-header-title gradient-text">Yaku Makki</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">é¦–é¡µ</a>
             | 
          
          <a class="app-header-menu-item" href="/post/">åšå®¢</a>
             | 
          
          <a class="app-header-menu-item" href="/wiki/">ç»´åŸº</a>
             | 
          
          <a class="app-header-menu-item" href="/tags/">æ ‡ç­¾</a>
             | 
          
          <a class="app-header-menu-item" href="/about/">å…³äº</a>
      </nav>
      <p>ä¸ªäººå°å·¢</p>
      <div class="app-header-social">
        
          <a href="https://github.com/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="mailto:yakumakki947@hotmail.com" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-mail" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>mail</title><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          </a>
        
          <a href="https://x.com/Makki_Yaku947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
          </a>
        
          <a href="https://www.twitch.tv/u/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-twitch" viewBox="0 0 24 24" fill="currentColor"><title>Twitch</title><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container glass-morphism glow-effect">
      <div class="floating-particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 6s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 7s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 8s;"></div>
      </div>
      
  <article class="post enhanced-card glow-effect">
    <header class="post-header">
      <h1 class ="post-title gradient-text">ç¥ç»ç½‘ç»œåŸºç¡€</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Oct 19, 2025
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          5 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="ç¥ç»ç½‘ç»œåŸºç¡€">ç¥ç»ç½‘ç»œåŸºç¡€</h1>
<p>ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰æ˜¯æ·±åº¦å­¦ä¹ çš„åŸºç¡€ï¼Œæ¨¡æ‹Ÿäº†äººè„‘ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ã€‚æœ¬ç« è¯¦ç»†ä»‹ç»ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µã€ç»“æ„å’Œè®­ç»ƒæ–¹æ³•ã€‚</p>
<h2 id="-ç¥ç»å…ƒæ¨¡å‹">ğŸ§  ç¥ç»å…ƒæ¨¡å‹</h2>
<h3 id="ç”Ÿç‰©ç¥ç»å…ƒ">ç”Ÿç‰©ç¥ç»å…ƒ</h3>
<p>äººè„‘ä¸­çš„ç¥ç»å…ƒé€šè¿‡çªè§¦æ¥æ”¶å’Œå¤„ç†ä¿¡å·ï¼Œç¥ç»ç½‘ç»œä¸­çš„äººå·¥ç¥ç»å…ƒæ¨¡ä»¿äº†è¿™ä¸€è¿‡ç¨‹ã€‚</p>
<h3 id="äººå·¥ç¥ç»å…ƒ">äººå·¥ç¥ç»å…ƒ</h3>
<p>äººå·¥ç¥ç»å…ƒï¼ˆArtificial Neuronï¼‰æ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒï¼š</p>
<p><strong>æ•°å­¦æ¨¡å‹</strong>ï¼š
$$z = \sum_{i=1}^{n} w_i x_i + b$$
$$a = g(z)$$</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>$x_i$ï¼šè¾“å…¥ç‰¹å¾</li>
<li>$w_i$ï¼šæƒé‡å‚æ•°</li>
<li>$b$ï¼šåç½®é¡¹</li>
<li>$g(\cdot)$ï¼šæ¿€æ´»å‡½æ•°</li>
<li>$a$ï¼šç¥ç»å…ƒè¾“å‡º</li>
</ul>
<h3 id="ç¥ç»ç½‘ç»œç»“æ„">ç¥ç»ç½‘ç»œç»“æ„</h3>
<p><strong>å•å±‚ç¥ç»ç½‘ç»œ</strong>ï¼š</p>
<pre tabindex="0"><code>è¾“å…¥å±‚ â†’ è¾“å‡ºå±‚
</code></pre><p><strong>å¤šå±‚ç¥ç»ç½‘ç»œ</strong>ï¼š</p>
<pre tabindex="0"><code>è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ ... â†’ è¾“å‡ºå±‚
</code></pre><h2 id="-å‰å‘ä¼ æ’­">ğŸ”„ å‰å‘ä¼ æ’­</h2>
<h3 id="è®¡ç®—è¿‡ç¨‹">è®¡ç®—è¿‡ç¨‹</h3>
<p><strong>ç¬¬ä¸€å±‚</strong>ï¼š
$$z^{(1)} = W^{(1)} x + b^{(1)}$$
$$a^{(1)} = g^{(1)}(z^{(1)})$$</p>
<p><strong>ç¬¬lå±‚</strong>ï¼š
$$z^{(l)} = W^{(l)} a^{(l-1)} + b^{(l)}$$
$$a^{(l)} = g^{(l)}(z^{(l)})$$</p>
<h3 id="å‘é‡è¡¨ç¤º">å‘é‡è¡¨ç¤º</h3>
<p>ä½¿ç”¨çŸ©é˜µè¿ç®—æé«˜æ•ˆç‡ï¼š
$$Z = W \cdot A + b$$
$$A = g(Z)$$</p>
<h2 id="-åå‘ä¼ æ’­">ğŸ“‰ åå‘ä¼ æ’­</h2>
<h3 id="æŸå¤±å‡½æ•°">æŸå¤±å‡½æ•°</h3>
<p><strong>å‡æ–¹è¯¯å·® (MSE)</strong>ï¼š
$$J = \frac{1}{m} \sum_{i=1}^{m} (y_i - \hat{y}_i)^2$$</p>
<p><strong>äº¤å‰ç†µæŸå¤±</strong>ï¼š
$$J = -\frac{1}{m} \sum_{i=1}^{m} [y_i \log \hat{y}_i + (1-y_i) \log (1-\hat{y}_i)]$$</p>
<h3 id="æ¢¯åº¦è®¡ç®—">æ¢¯åº¦è®¡ç®—</h3>
<p><strong>è¾“å‡ºå±‚æ¢¯åº¦</strong>ï¼š
$$\frac{\partial J}{\partial z^{(L)}} = a^{(L)} - y$$</p>
<p><strong>éšè—å±‚æ¢¯åº¦</strong>ï¼š
$$\frac{\partial J}{\partial z^{(l)}} = \frac{\partial J}{\partial z^{(l+1)}} \cdot (W^{(l+1)})^T \odot g&rsquo;(z^{(l)})$$</p>
<h2 id="-æ¿€æ´»å‡½æ•°">âš¡ æ¿€æ´»å‡½æ•°</h2>
<h3 id="sigmoidå‡½æ•°">Sigmoidå‡½æ•°</h3>
<p>$$\sigma(z) = \frac{1}{1 + e^{-z}}$$</p>
<p><strong>å¯¼æ•°</strong>ï¼š
$$\sigma&rsquo;(z) = \sigma(z) (1 - \sigma(z))$$</p>
<h3 id="reluå‡½æ•°">ReLUå‡½æ•°</h3>
<p>$$ReLU(z) = \max(0, z)$$</p>
<p><strong>å¯¼æ•°</strong>ï¼š
$$ReLU&rsquo;(z) = \begin{cases}
1 &amp; z &gt; 0 \
0 &amp; z \leq 0
\end{cases}$$</p>
<h3 id="tanhå‡½æ•°">Tanhå‡½æ•°</h3>
<p>$$\tanh(z) = \frac{e^z - e^{-z}}{e^z + e^{-z}}$$</p>
<p><strong>å¯¼æ•°</strong>ï¼š
$$\tanh&rsquo;(z) = 1 - \tanh^2(z)$$</p>
<h2 id="-æ¢¯åº¦ä¸‹é™">ğŸ¯ æ¢¯åº¦ä¸‹é™</h2>
<h3 id="æ‰¹é‡æ¢¯åº¦ä¸‹é™-bgd">æ‰¹é‡æ¢¯åº¦ä¸‹é™ (BGD)</h3>
<p><strong>å‚æ•°æ›´æ–°</strong>ï¼š
$$W = W - \alpha \frac{\partial J}{\partial W}$$
$$b = b - \alpha \frac{\partial J}{\partial b}$$</p>
<h3 id="éšæœºæ¢¯åº¦ä¸‹é™-sgd">éšæœºæ¢¯åº¦ä¸‹é™ (SGD)</h3>
<p><strong>å‚æ•°æ›´æ–°</strong>ï¼š
$$W = W - \alpha \frac{\partial J^{(i)}}{\partial W}$$
$$b = b - \alpha \frac{\partial J^{(i)}}{\partial b}$$</p>
<h3 id="å°æ‰¹é‡æ¢¯åº¦ä¸‹é™-mini-batch-sgd">å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ (Mini-batch SGD)</h3>
<p>ç»“åˆBGDå’ŒSGDçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ¯æ¬¡ä½¿ç”¨ä¸€å°æ‰¹æ ·æœ¬è®¡ç®—æ¢¯åº¦</li>
<li>æ”¶æ•›é€Ÿåº¦å¿«ä¸”æ›´ç¨³å®š</li>
</ul>
<h2 id="-ç½‘ç»œæ¶æ„">ğŸ—ï¸ ç½‘ç»œæ¶æ„</h2>
<h3 id="å‰é¦ˆç¥ç»ç½‘ç»œ-fnn">å‰é¦ˆç¥ç»ç½‘ç»œ (FNN)</h3>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¿¡æ¯å•å‘æµåŠ¨</li>
<li>æ²¡æœ‰å¾ªç¯è¿æ¥</li>
<li>é€‚åˆåˆ†ç±»å’Œå›å½’ä»»åŠ¡</li>
</ul>
<h3 id="æ·±åº¦ç¥ç»ç½‘ç»œ-dnn">æ·±åº¦ç¥ç»ç½‘ç»œ (DNN)</h3>
<p><strong>æ·±åº¦</strong>ï¼šé€šå¸¸æŒ‡å…·æœ‰å¤šä¸ªéšè—å±‚çš„ç½‘ç»œ
<strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å­¦ä¹ æ›´å¤æ‚çš„ç‰¹å¾è¡¨ç¤º</li>
<li>è§£å†³æ›´å¤æ‚çš„å®é™…é—®é¢˜</li>
</ul>
<h2 id="-è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–">ğŸ“Š è¿‡æ‹Ÿåˆä¸æ­£åˆ™åŒ–</h2>
<h3 id="è¿‡æ‹Ÿåˆé—®é¢˜">è¿‡æ‹Ÿåˆé—®é¢˜</h3>
<p><strong>è¡¨ç°</strong>ï¼š</p>
<ul>
<li>è®­ç»ƒè¯¯å·®ä½ï¼Œæµ‹è¯•è¯¯å·®é«˜</li>
<li>æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¾ˆå¥½</li>
<li>åœ¨æ–°æ•°æ®ä¸Šè¡¨ç°å¾ˆå·®</li>
</ul>
<h3 id="l2æ­£åˆ™åŒ–">L2æ­£åˆ™åŒ–</h3>
<p><strong>æŸå¤±å‡½æ•°</strong>ï¼š
$$J_{regularized} = J + \frac{\lambda}{2m} \sum_{l=1}^{L} |W^{(l)}|_F^2$$</p>
<p><strong>æ¢¯åº¦</strong>ï¼š
$$\frac{\partial J_{regularized}}{\partial W} = \frac{\partial J}{\partial W} + \frac{\lambda}{m} W$$</p>
<h3 id="dropout">Dropout</h3>
<p><strong>è®­ç»ƒæ—¶</strong>ï¼šéšæœºä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒ
<strong>æµ‹è¯•æ—¶</strong>ï¼šä½¿ç”¨æ‰€æœ‰ç¥ç»å…ƒä½†æƒé‡ç¼©æ”¾</p>
<h2 id="-ç¼–ç¨‹å®ç°">ğŸš€ ç¼–ç¨‹å®ç°</h2>
<h3 id="pytorchå®ç°">PyTorchå®ç°</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> torch.nn <span style="color:#66d9ef">as</span> nn
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> torch.optim <span style="color:#66d9ef">as</span> optim
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NeuralNetwork</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, input_size, hidden_size, output_size):
</span></span><span style="display:flex;"><span>        super(NeuralNetwork, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>layer1 <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Linear(input_size, hidden_size)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>layer2 <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Linear(hidden_size, output_size)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>relu <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>ReLU()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, x):
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>relu(self<span style="color:#f92672">.</span>layer1(x))
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>layer2(x)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¨¡å‹åˆå§‹åŒ–</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> NeuralNetwork(<span style="color:#ae81ff">784</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span>
</span></span><span style="display:flex;"><span>criterion <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>CrossEntropyLoss()
</span></span><span style="display:flex;"><span>optimizer <span style="color:#f92672">=</span> optim<span style="color:#f92672">.</span>Adam(model<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.001</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒè¿‡ç¨‹</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(num_epochs):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> data, target <span style="color:#f92672">in</span> dataloader:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å‰å‘ä¼ æ’­</span>
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">=</span> model(data)
</span></span><span style="display:flex;"><span>        loss <span style="color:#f92672">=</span> criterion(output, target)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åå‘ä¼ æ’­</span>
</span></span><span style="display:flex;"><span>        optimizer<span style="color:#f92672">.</span>zero_grad()
</span></span><span style="display:flex;"><span>        loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>        optimizer<span style="color:#f92672">.</span>step()
</span></span></code></pre></div><h3 id="æ‰‹åŠ¨å®ç°åå‘ä¼ æ’­">æ‰‹åŠ¨å®ç°åå‘ä¼ æ’­</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward_propagation</span>(X, parameters):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;å‰å‘ä¼ æ’­&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    W1, b1, W2, b2 <span style="color:#f92672">=</span> parameters
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç¬¬ä¸€å±‚</span>
</span></span><span style="display:flex;"><span>    Z1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(W1, X) <span style="color:#f92672">+</span> b1
</span></span><span style="display:flex;"><span>    A1 <span style="color:#f92672">=</span> relu(Z1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç¬¬äºŒå±‚</span>
</span></span><span style="display:flex;"><span>    Z2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(W2, A1) <span style="color:#f92672">+</span> b2
</span></span><span style="display:flex;"><span>    A2 <span style="color:#f92672">=</span> softmax(Z2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cache <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Z1&#34;</span>: Z1, <span style="color:#e6db74">&#34;A1&#34;</span>: A1, <span style="color:#e6db74">&#34;Z2&#34;</span>: Z2, <span style="color:#e6db74">&#34;A2&#34;</span>: A2}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> A2, cache
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">backward_propagation</span>(parameters, cache, X, Y):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;åå‘ä¼ æ’­&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    W1, b1, W2, b2 <span style="color:#f92672">=</span> parameters
</span></span><span style="display:flex;"><span>    Z1, A1, Z2, A2 <span style="color:#f92672">=</span> cache<span style="color:#f92672">.</span>values()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># è¾“å‡ºå±‚æ¢¯åº¦</span>
</span></span><span style="display:flex;"><span>    dZ2 <span style="color:#f92672">=</span> A2 <span style="color:#f92672">-</span> Y
</span></span><span style="display:flex;"><span>    dW2 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>m) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>dot(dZ2, A1<span style="color:#f92672">.</span>T)
</span></span><span style="display:flex;"><span>    db2 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>m) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(dZ2, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, keepdims<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># éšè—å±‚æ¢¯åº¦</span>
</span></span><span style="display:flex;"><span>    dZ1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(W2<span style="color:#f92672">.</span>T, dZ2) <span style="color:#f92672">*</span> relu_derivative(Z1)
</span></span><span style="display:flex;"><span>    dW1 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>m) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>dot(dZ1, X<span style="color:#f92672">.</span>T)
</span></span><span style="display:flex;"><span>    db1 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>m) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>sum(dZ1, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, keepdims<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gradients <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;dW1&#34;</span>: dW1, <span style="color:#e6db74">&#34;db1&#34;</span>: db1, <span style="color:#e6db74">&#34;dW2&#34;</span>: dW2, <span style="color:#e6db74">&#34;db2&#34;</span>: db2}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> gradients
</span></span></code></pre></div><h2 id="-æ¿€æ´»å‡½æ•°å¯è§†åŒ–">ğŸ¨ æ¿€æ´»å‡½æ•°å¯è§†åŒ–</h2>
<h3 id="sigmoidå‡½æ•°-1">Sigmoidå‡½æ•°</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sigmoid</span>(z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>z))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sigmoid_derivative</span>(z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sigmoid(z) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> sigmoid(z))
</span></span></code></pre></div><h3 id="reluå‡½æ•°-1">ReLUå‡½æ•°</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">relu</span>(z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>maximum(<span style="color:#ae81ff">0</span>, z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">relu_derivative</span>(z):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>where(z <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><h2 id="-è®­ç»ƒæŠ€å·§">ğŸ“ˆ è®­ç»ƒæŠ€å·§</h2>
<h3 id="æƒé‡åˆå§‹åŒ–">æƒé‡åˆå§‹åŒ–</h3>
<p><strong>Xavieråˆå§‹åŒ–</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xavier_init</span>(fan_in, fan_out):
</span></span><span style="display:flex;"><span>    limit <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(<span style="color:#ae81ff">6</span> <span style="color:#f92672">/</span> (fan_in <span style="color:#f92672">+</span> fan_out))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#f92672">-</span>limit, limit, (fan_out, fan_in))
</span></span></code></pre></div><h3 id="å­¦ä¹ ç‡è¡°å‡">å­¦ä¹ ç‡è¡°å‡</h3>
<p><strong>æŒ‡æ•°è¡°å‡</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>learning_rate <span style="color:#f92672">=</span> initial_lr <span style="color:#f92672">*</span> decay_rate <span style="color:#f92672">**</span> epoch
</span></span></code></pre></div><h3 id="æ¢¯åº¦æ£€æŸ¥">æ¢¯åº¦æ£€æŸ¥</h3>
<p>éªŒè¯åå‘ä¼ æ’­çš„æ­£ç¡®æ€§ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gradient_check</span>(parameters, gradients, X, Y, epsilon<span style="color:#f92672">=</span><span style="color:#ae81ff">1e-7</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> param_name <span style="color:#f92672">in</span> parameters:
</span></span><span style="display:flex;"><span>        param <span style="color:#f92672">=</span> parameters[param_name]
</span></span><span style="display:flex;"><span>        grad <span style="color:#f92672">=</span> gradients[<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#f92672">+</span> param_name]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è®¡ç®—æ•°å€¼æ¢¯åº¦</span>
</span></span><span style="display:flex;"><span>        numerical_grad <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros_like(param)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(param<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(param<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]):
</span></span><span style="display:flex;"><span>                param_plus <span style="color:#f92672">=</span> param<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>                param_minus <span style="color:#f92672">=</span> param<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>                param_plus[i,j] <span style="color:#f92672">+=</span> epsilon
</span></span><span style="display:flex;"><span>                param_minus[i,j] <span style="color:#f92672">-=</span> epsilon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                loss_plus <span style="color:#f92672">=</span> compute_loss(param_plus)
</span></span><span style="display:flex;"><span>                loss_minus <span style="color:#f92672">=</span> compute_loss(param_minus)
</span></span><span style="display:flex;"><span>                numerical_grad[i,j] <span style="color:#f92672">=</span> (loss_plus <span style="color:#f92672">-</span> loss_minus) <span style="color:#f92672">/</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> epsilon)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># æ¯”è¾ƒæ¢¯åº¦</span>
</span></span><span style="display:flex;"><span>        diff <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>norm(grad <span style="color:#f92672">-</span> numerical_grad) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>norm(grad <span style="color:#f92672">+</span> numerical_grad)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>param_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> gradient check: </span><span style="color:#e6db74">{</span>diff<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="-è¶…å‚æ•°è°ƒä¼˜">ğŸ”§ è¶…å‚æ•°è°ƒä¼˜</h2>
<h3 id="ç½‘æ ¼æœç´¢">ç½‘æ ¼æœç´¢</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>learning_rates <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.001</span>, <span style="color:#ae81ff">0.01</span>, <span style="color:#ae81ff">0.1</span>]
</span></span><span style="display:flex;"><span>hidden_sizes <span style="color:#f92672">=</span> [<span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">256</span>]
</span></span><span style="display:flex;"><span>batch_sizes <span style="color:#f92672">=</span> [<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">128</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>best_accuracy <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>best_params <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> lr <span style="color:#f92672">in</span> learning_rates:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> hidden_size <span style="color:#f92672">in</span> hidden_sizes:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> batch_size <span style="color:#f92672">in</span> batch_sizes:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>            accuracy <span style="color:#f92672">=</span> train_model(lr, hidden_size, batch_size)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> accuracy <span style="color:#f92672">&gt;</span> best_accuracy:
</span></span><span style="display:flex;"><span>                best_accuracy <span style="color:#f92672">=</span> accuracy
</span></span><span style="display:flex;"><span>                best_params <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;lr&#39;</span>: lr, <span style="color:#e6db74">&#39;hidden_size&#39;</span>: hidden_size, <span style="color:#e6db74">&#39;batch_size&#39;</span>: batch_size}
</span></span></code></pre></div><h3 id="éšæœºæœç´¢">éšæœºæœç´¢</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">random_search</span>(num_trials<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>):
</span></span><span style="display:flex;"><span>    best_accuracy <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    best_params <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(num_trials):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># éšæœºé‡‡æ ·è¶…å‚æ•°</span>
</span></span><span style="display:flex;"><span>        lr <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">**</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        hidden_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>)
</span></span><span style="display:flex;"><span>        batch_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è®­ç»ƒå¹¶è¯„ä¼°</span>
</span></span><span style="display:flex;"><span>        accuracy <span style="color:#f92672">=</span> train_model(lr, hidden_size, batch_size)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> accuracy <span style="color:#f92672">&gt;</span> best_accuracy:
</span></span><span style="display:flex;"><span>            best_accuracy <span style="color:#f92672">=</span> accuracy
</span></span><span style="display:flex;"><span>            best_params <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;lr&#39;</span>: lr, <span style="color:#e6db74">&#39;hidden_size&#39;</span>: hidden_size, <span style="color:#e6db74">&#39;batch_size&#39;</span>: batch_size}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> best_params
</span></span></code></pre></div><h2 id="-è¯„ä¼°æŒ‡æ ‡">ğŸ“Š è¯„ä¼°æŒ‡æ ‡</h2>
<h3 id="åˆ†ç±»ä»»åŠ¡">åˆ†ç±»ä»»åŠ¡</h3>
<p><strong>å‡†ç¡®ç‡ (Accuracy)</strong>ï¼š
$$Accuracy = \frac{TP + TN}{TP + TN + FP + FN}$$</p>
<p><strong>ç²¾ç¡®ç‡ (Precision)</strong>ï¼š
$$Precision = \frac{TP}{TP + FP}$$</p>
<p><strong>å¬å›ç‡ (Recall)</strong>ï¼š
$$Recall = \frac{TP}{TP + FN}$$</p>
<p><strong>F1åˆ†æ•°</strong>ï¼š
$$F1 = 2 \times \frac{Precision \times Recall}{Precision + Recall}$$</p>
<h3 id="å›å½’ä»»åŠ¡">å›å½’ä»»åŠ¡</h3>
<p><strong>å‡æ–¹è¯¯å·® (MSE)</strong>ï¼š
$$MSE = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2$$</p>
<p><strong>å¹³å‡ç»å¯¹è¯¯å·® (MAE)</strong>ï¼š
$$MAE = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i|$$</p>
<h2 id="-åº”ç”¨å®ä¾‹">ğŸ¯ åº”ç”¨å®ä¾‹</h2>
<h3 id="æ‰‹å†™æ•°å­—è¯†åˆ«">æ‰‹å†™æ•°å­—è¯†åˆ«</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½MNISTæ•°æ®é›†</span>
</span></span><span style="display:flex;"><span>transform <span style="color:#f92672">=</span> transforms<span style="color:#f92672">.</span>Compose([
</span></span><span style="display:flex;"><span>    transforms<span style="color:#f92672">.</span>ToTensor(),
</span></span><span style="display:flex;"><span>    transforms<span style="color:#f92672">.</span>Normalize((<span style="color:#ae81ff">0.5</span>,), (<span style="color:#ae81ff">0.5</span>,))
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>trainset <span style="color:#f92672">=</span> torchvision<span style="color:#f92672">.</span>datasets<span style="color:#f92672">.</span>MNIST(root<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./data&#39;</span>, train<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, download<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, transform<span style="color:#f92672">=</span>transform)
</span></span><span style="display:flex;"><span>trainloader <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>DataLoader(trainset, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¨¡å‹å®šä¹‰</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MNISTNet</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        super(MNISTNet, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>fc1 <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">28</span><span style="color:#f92672">*</span><span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>fc2 <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>fc3 <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, x):
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>view(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">28</span><span style="color:#f92672">*</span><span style="color:#ae81ff">28</span>)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>relu(self<span style="color:#f92672">.</span>fc1(x))
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>relu(self<span style="color:#f92672">.</span>fc2(x))
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>fc3(x)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> MNISTNet()
</span></span><span style="display:flex;"><span>criterion <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>CrossEntropyLoss()
</span></span><span style="display:flex;"><span>optimizer <span style="color:#f92672">=</span> optim<span style="color:#f92672">.</span>Adam(model<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.001</span>)
</span></span></code></pre></div><h2 id="-å­¦ä¹ èµ„æº">ğŸ“š å­¦ä¹ èµ„æº</h2>
<h3 id="å´æ©è¾¾è¯¾ç¨‹">å´æ©è¾¾è¯¾ç¨‹</h3>
<ul>
<li><a href="https://www.coursera.org/learn/neural-networks-deep-learning">ç¬¬ä¸€å‘¨ï¼šç¥ç»ç½‘ç»œå’Œæ·±åº¦å­¦ä¹ åŸºç¡€</a></li>
</ul>
<h3 id="ç»å…¸è®ºæ–‡">ç»å…¸è®ºæ–‡</h3>
<ul>
<li><a href="https://www.cs.cmu.edu/~./epxing/Class/10715/reading/McCulloch.and.Pitts.pdf">A Logical Calculus of the Ideas Immanent in Nervous Activity</a> - McCulloch &amp; Pitts (1943)</li>
<li><a href="https://www.iro.umontreal.ca/~pift6266/A06/refs/backprop.pdf">Learning Internal Representations by Error Propagation</a> - Rumelhart et al. (1986)</li>
</ul>
<h3 id="åœ¨çº¿èµ„æº">åœ¨çº¿èµ„æº</h3>
<ul>
<li><a href="http://neuralnetworksanddeeplearning.com/">Neural Networks and Deep Learning</a></li>
<li><a href="https://cs231n.github.io/">CS231n: Convolutional Neural Networks</a></li>
</ul>

      
      <div class="post-separator">------------------------------------------------------------------------</div>
      
    </div>
    <div class="post-footer">
      
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <div class="busuanzi-container">
        <span id="busuanzi_container_page_pv">--æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡--</span>
      </div>
      
      
      <script src="https://utteranc.es/client.js"
        repo="makkichan947/makkichan947.github.io"
        issue-term="pathname"
        label="Utterances"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
    </div>
  </article>

    </main>
  </body>
</html>
