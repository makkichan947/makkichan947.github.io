<!doctype html>
<html lang="zh">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>TensorFlowåŸºç¡€æ•™ç¨‹ // Yaku Makki</title>
    <link rel="shortcut icon" href="./avatar.jpg" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.151.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Yaku Makki" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.422840b4454cb211f5b3dab61f082cdff508e88825173c31806835cb75529734.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="TensorFlowåŸºç¡€æ•™ç¨‹">
  <meta name="twitter:description" content="TensorFlowåŸºç¡€æ•™ç¨‹ æœ¬æ•™ç¨‹å°†ä»é›¶å¼€å§‹ä»‹ç»TensorFlowçš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬ç¯å¢ƒæ­å»ºã€åŸºæœ¬æ¦‚å¿µã€ç®€å•æ¨¡å‹æ„å»ºå’Œè®­ç»ƒã€‚é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å°†èƒ½å¤Ÿä½¿ç”¨TensorFlowæ„å»ºå’Œè®­ç»ƒåŸºæœ¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚
ğŸ› ï¸ ç¯å¢ƒæ­å»º å®‰è£…TensorFlow # CPUç‰ˆæœ¬ pip install tensorflow # GPUç‰ˆæœ¬ï¼ˆéœ€è¦CUDAæ”¯æŒï¼‰ pip install tensorflow[and-cuda] # éªŒè¯å®‰è£… python -c &#34;import tensorflow as tf; print(tf.config.list_physical_devices(&#39;GPU&#39; if tf.test.is_gpu_available() else &#39;CPU&#39;))&#34; æ¨èå¼€å‘ç¯å¢ƒ # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ conda create -n tf_env python=3.9 conda activate tf_env # å®‰è£…TensorFlowå’Œç›¸å…³ä¾èµ– pip install tensorflow numpy matplotlib jupyter pandas scikit-learn # å¯åŠ¨Jupyter Notebook jupyter notebook ğŸ¯ åŸºç¡€æ¦‚å¿µ Hello TensorFlow import tensorflow as tf # æ‰“å°TensorFlowç‰ˆæœ¬ print(f&#34;TensorFlowç‰ˆæœ¬: {tf.__version__}&#34;) # åˆ›å»ºå¸¸é‡å¼ é‡ hello = tf.constant(&#34;Hello, TensorFlow!&#34;) print(f&#34;å¸¸é‡: {hello.numpy()}&#34;) # åŸºæœ¬è¿ç®— a = tf.constant(5) b = tf.constant(3) print(f&#34;5 &#43; 3 = {tf.add(a, b).numpy()}&#34;) print(f&#34;5 * 3 = {tf.multiply(a, b).numpy()}&#34;) å¼ é‡æ“ä½œ import tensorflow as tf import numpy as np # åˆ›å»ºä¸åŒç±»å‹çš„å¼ é‡ scalar = tf.constant(42) # æ ‡é‡ vector = tf.constant([1, 2, 3, 4, 5]) # å‘é‡ matrix = tf.constant([[1, 2], [3, 4], [5, 6]]) # çŸ©é˜µ tensor_3d = tf.constant(np.random.rand(2, 3, 4)) # ä¸‰ç»´å¼ é‡ print(f&#34;æ ‡é‡å½¢çŠ¶: {scalar.shape}&#34;) print(f&#34;å‘é‡å½¢çŠ¶: {vector.shape}&#34;) print(f&#34;çŸ©é˜µå½¢çŠ¶: {matrix.shape}&#34;) print(f&#34;ä¸‰ç»´å¼ é‡å½¢çŠ¶: {tensor_3d.shape}&#34;) # å¼ é‡è¿ç®— x = tf.constant([1, 2, 3, 4, 5]) y = tf.constant([6, 7, 8, 9, 10]) # å…ƒç´ çº§è¿ç®— print(f&#34;x &#43; y = {tf.add(x, y).numpy()}&#34;) print(f&#34;x * y = {tf.multiply(x, y).numpy()}&#34;) # å¹¿æ’­æœºåˆ¶ matrix = tf.constant([[1, 2], [3, 4]]) vector = tf.constant([5, 6]) print(f&#34;çŸ©é˜µ &#43; å‘é‡å¹¿æ’­ç»“æœ:\n{tf.add(matrix, vector).numpy()}&#34;) ğŸ—ï¸ ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ çº¿æ€§å›å½’æ¨¡å‹ import tensorflow as tf import numpy as np import matplotlib.pyplot as plt # ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ® np.random.seed(42) X = np.random.rand(100, 1) * 10 y = 2 * X &#43; 1 &#43; np.random.randn(100, 1) * 0.5 # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(1, input_shape=(1,)) ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;sgd&#39;, # éšæœºæ¢¯åº¦ä¸‹é™ loss=&#39;mse&#39;, # å‡æ–¹è¯¯å·® metrics=[&#39;mae&#39;] # å¹³å‡ç»å¯¹è¯¯å·® ) # æ¨¡å‹æ‘˜è¦ model.summary() # è®­ç»ƒæ¨¡å‹ history = model.fit(X, y, epochs=100, verbose=0) # é¢„æµ‹ y_pred = model.predict(X) # å¯è§†åŒ–ç»“æœ plt.figure(figsize=(12, 4)) plt.subplot(1, 2, 1) plt.scatter(X, y, alpha=0.5, label=&#39;çœŸå®æ•°æ®&#39;) plt.plot(X, y_pred, color=&#39;red&#39;, label=&#39;é¢„æµ‹ç»“æœ&#39;) plt.xlabel(&#39;X&#39;) plt.ylabel(&#39;y&#39;) plt.title(&#39;çº¿æ€§å›å½’ç»“æœ&#39;) plt.legend() plt.subplot(1, 2, 2) plt.plot(history.history[&#39;loss&#39;]) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Loss&#39;) plt.title(&#39;è®­ç»ƒæŸå¤±æ›²çº¿&#39;) plt.tight_layout() plt.show() print(f&#34;æ¨¡å‹æƒé‡: {model.weights[0].numpy().flatten()}&#34;) print(f&#34;æ¨¡å‹åç½®: {model.weights[1].numpy()}&#34;) åˆ†ç±»æ¨¡å‹ - MNISTæ‰‹å†™æ•°å­—è¯†åˆ« import tensorflow as tf from tensorflow.keras.datasets import mnist from tensorflow.keras.utils import to_categorical # åŠ è½½MNISTæ•°æ®é›† (x_train, y_train), (x_test, y_test) = mnist.load_data() # æ•°æ®é¢„å¤„ç† x_train = x_train.reshape(-1, 784) / 255.0 # å±•å¹³å¹¶å½’ä¸€åŒ– x_test = x_test.reshape(-1, 784) / 255.0 y_train = to_categorical(y_train, 10) # one-hotç¼–ç  y_test = to_categorical(y_test, 10) # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(128, activation=&#39;relu&#39;, input_shape=(784,)), tf.keras.layers.Dropout(0.2), # Dropouté˜²æ­¢è¿‡æ‹Ÿåˆ tf.keras.layers.Dense(64, activation=&#39;relu&#39;), tf.keras.layers.Dense(10, activation=&#39;softmax&#39;) # è¾“å‡ºå±‚ ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;adam&#39;, # Adamä¼˜åŒ–å™¨ loss=&#39;categorical_crossentropy&#39;, # äº¤å‰ç†µæŸå¤± metrics=[&#39;accuracy&#39;] # å‡†ç¡®ç‡ ) # è®­ç»ƒæ¨¡å‹ history = model.fit( x_train, y_train, batch_size=128, epochs=10, validation_split=0.1, # éªŒè¯é›† verbose=1 ) # è¯„ä¼°æ¨¡å‹ test_loss, test_acc = model.evaluate(x_test, y_test, verbose=0) print(f&#34;æµ‹è¯•é›†å‡†ç¡®ç‡: {test_acc:.4f}&#34;) # é¢„æµ‹ predictions = model.predict(x_test[:5]) predicted_labels = tf.argmax(predictions, axis=1).numpy() true_labels = tf.argmax(y_test[:5], axis=1).numpy() print(&#34;é¢„æµ‹ç»“æœ:&#34;, predicted_labels) print(&#34;çœŸå®æ ‡ç­¾:&#34;, true_labels) ğŸ“Š æ•°æ®å¤„ç† ä½¿ç”¨tf.data API import tensorflow as tf import numpy as np # åˆ›å»ºæ•°æ®é›† def create_dataset(): # ç”Ÿæˆéšæœºæ•°æ® X = np.random.rand(1000, 10) y = np.random.randint(0, 2, 1000) # åˆ›å»ºtf.data.Dataset dataset = tf.data.Dataset.from_tensor_slices((X, y)) # æ•°æ®é¢„å¤„ç† def preprocess(x, y): # å½’ä¸€åŒ– x = (x - tf.reduce_mean(x)) / tf.math.reduce_std(x) return x, y # åº”ç”¨é¢„å¤„ç† dataset = dataset.map(preprocess) # æ‰“ä¹±å’Œæ‰¹å¤„ç† dataset = dataset.shuffle(buffer_size=100) dataset = dataset.batch(32) # é‡å¤å’Œé¢„å– dataset = dataset.repeat() dataset = dataset.prefetch(tf.data.AUTOTUNE) return dataset # ä½¿ç”¨æ•°æ®é›†è®­ç»ƒ dataset = create_dataset() model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(32, activation=&#39;relu&#39;), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) model.compile(optimizer=&#39;adam&#39;, loss=&#39;binary_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) # è®­ç»ƒ model.fit(dataset, epochs=5, steps_per_epoch=10) å›¾åƒæ•°æ®å¢å¼º from tensorflow.keras.preprocessing.image import ImageDataGenerator # åˆ›å»ºå›¾åƒæ•°æ®ç”Ÿæˆå™¨ datagen = ImageDataGenerator( rotation_range=20, # éšæœºæ—‹è½¬è§’åº¦ width_shift_range=0.1, # æ°´å¹³å¹³ç§» height_shift_range=0.1, # å‚ç›´å¹³ç§» shear_range=0.1, # å‰ªåˆ‡å˜æ¢ zoom_range=0.1, # ç¼©æ”¾ horizontal_flip=True, # æ°´å¹³ç¿»è½¬ fill_mode=&#39;nearest&#39; # å¡«å……æ¨¡å¼ ) # åº”ç”¨æ•°æ®å¢å¼º # datagen.fit(x_train) # å¦‚æœéœ€è¦çš„è¯ # enhanced_data = datagen.flow(x_train, y_train, batch_size=32) ğŸ¨ è‡ªå®šä¹‰æ¨¡å‹å’Œå±‚ è‡ªå®šä¹‰å±‚ import tensorflow as tf class CustomDense(tf.keras.layers.Layer): def __init__(self, units, activation=None, **kwargs): super(CustomDense, self).__init__(**kwargs) self.units = units self.activation = tf.keras.activations.get(activation) def build(self, input_shape): # åˆ›å»ºæƒé‡ self.w = self.add_weight( name=&#39;kernel&#39;, shape=(input_shape[-1], self.units), initializer=&#39;glorot_uniform&#39;, trainable=True ) self.b = self.add_weight( name=&#39;bias&#39;, shape=(self.units,), initializer=&#39;zeros&#39;, trainable=True ) def call(self, inputs): # å‰å‘ä¼ æ’­ output = tf.matmul(inputs, self.w) &#43; self.b if self.activation is not None: output = self.activation(output) return output def get_config(self): # åºåˆ—åŒ–é…ç½® config = super(CustomDense, self).get_config() config.update({ &#39;units&#39;: self.units, &#39;activation&#39;: tf.keras.activations.serialize(self.activation) }) return config # ä½¿ç”¨è‡ªå®šä¹‰å±‚ model = tf.keras.Sequential([ CustomDense(128, activation=&#39;relu&#39;, input_shape=(784,)), CustomDense(64, activation=&#39;relu&#39;), CustomDense(10, activation=&#39;softmax&#39;) ]) è‡ªå®šä¹‰æ¨¡å‹ class CustomModel(tf.keras.Model): def __init__(self, num_classes): super(CustomModel, self).__init__() self.dense1 = tf.keras.layers.Dense(128, activation=&#39;relu&#39;) self.dense2 = tf.keras.layers.Dense(64, activation=&#39;relu&#39;) self.dense3 = tf.keras.layers.Dense(num_classes, activation=&#39;softmax&#39;) self.dropout = tf.keras.layers.Dropout(0.2) def call(self, inputs, training=False): x = self.dense1(inputs) x = self.dropout(x, training=training) x = self.dense2(x) x = self.dropout(x, training=training) return self.dense3(x) # ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹ model = CustomModel(num_classes=10) model.compile(optimizer=&#39;adam&#39;, loss=&#39;sparse_categorical_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) ğŸ”§ æ¨¡å‹ä¿å­˜å’ŒåŠ è½½ ä¿å­˜å’ŒåŠ è½½æ¨¡å‹ import tensorflow as tf # æ„å»ºå’Œè®­ç»ƒæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) model.compile(optimizer=&#39;adam&#39;, loss=&#39;binary_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) # è®­ç»ƒæ¨¡å‹ï¼ˆè¿™é‡Œä½¿ç”¨éšæœºæ•°æ®ä½œä¸ºç¤ºä¾‹ï¼‰ import numpy as np X_train = np.random.rand(100, 10) y_train = np.random.randint(0, 2, 100) model.fit(X_train, y_train, epochs=5, verbose=0) # ä¿å­˜å®Œæ•´æ¨¡å‹ model.save(&#39;my_model.h5&#39;) # HDF5æ ¼å¼ model.save(&#39;my_model&#39;) # TensorFlow SavedModelæ ¼å¼ # åŠ è½½æ¨¡å‹ loaded_model_h5 = tf.keras.models.load_model(&#39;my_model.h5&#39;) loaded_model = tf.keras.models.load_model(&#39;my_model&#39;) # æ¯”è¾ƒé¢„æµ‹ç»“æœ test_data = np.random.rand(5, 10) original_pred = model.predict(test_data) loaded_pred = loaded_model.predict(test_data) print(f&#34;é¢„æµ‹ç»“æœä¸€è‡´: {np.allclose(original_pred, loaded_pred)}&#34;) ä¿å­˜å’ŒåŠ è½½æƒé‡ # ä¿å­˜æ¨¡å‹æƒé‡ model.save_weights(&#39;model_weights.h5&#39;) # åˆ›å»ºç›¸åŒæ¶æ„çš„æ–°æ¨¡å‹ new_model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) # åŠ è½½æƒé‡ new_model.load_weights(&#39;model_weights.h5&#39;) # éªŒè¯æƒé‡æ˜¯å¦ç›¸åŒ original_weights = model.get_weights() loaded_weights = new_model.get_weights() for i, (orig, loaded) in enumerate(zip(original_weights, loaded_weights)): print(f&#34;æƒé‡{i}ä¸€è‡´: {np.allclose(orig, loaded)}&#34;) ğŸ“ˆ æ¨¡å‹è¯„ä¼°å’Œå¯è§†åŒ– è¯„ä¼°æŒ‡æ ‡ from sklearn.metrics import classification_report, confusion_matrix import seaborn as sns # é¢„æµ‹æµ‹è¯•é›† y_pred = model.predict(x_test) y_pred_classes = tf.argmax(y_pred, axis=1).numpy() y_true = tf.argmax(y_test, axis=1).numpy() # åˆ†ç±»æŠ¥å‘Š print(&#34;åˆ†ç±»æŠ¥å‘Š:&#34;) print(classification_report(y_true, y_pred_classes)) # æ··æ·†çŸ©é˜µ cm = confusion_matrix(y_true, y_pred_classes) plt.figure(figsize=(10, 8)) sns.heatmap(cm, annot=True, fmt=&#39;d&#39;, cmap=&#39;Blues&#39;) plt.xlabel(&#39;é¢„æµ‹æ ‡ç­¾&#39;) plt.ylabel(&#39;çœŸå®æ ‡ç­¾&#39;) plt.title(&#39;æ··æ·†çŸ©é˜µ&#39;) plt.show() è®­ç»ƒå†å²å¯è§†åŒ– import matplotlib.pyplot as plt # è®­ç»ƒå†å² history = model.fit(x_train, y_train, validation_data=(x_val, y_val), epochs=20) # ç»˜åˆ¶è®­ç»ƒæ›²çº¿ plt.figure(figsize=(12, 4)) # æŸå¤±æ›²çº¿ plt.subplot(1, 2, 1) plt.plot(history.history[&#39;loss&#39;], label=&#39;è®­ç»ƒæŸå¤±&#39;) plt.plot(history.history[&#39;val_loss&#39;], label=&#39;éªŒè¯æŸå¤±&#39;) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Loss&#39;) plt.title(&#39;è®­ç»ƒå’ŒéªŒè¯æŸå¤±&#39;) plt.legend() # å‡†ç¡®ç‡æ›²çº¿ plt.subplot(1, 2, 2) plt.plot(history.history[&#39;accuracy&#39;], label=&#39;è®­ç»ƒå‡†ç¡®ç‡&#39;) plt.plot(history.history[&#39;val_accuracy&#39;], label=&#39;éªŒè¯å‡†ç¡®ç‡&#39;) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Accuracy&#39;) plt.title(&#39;è®­ç»ƒå’ŒéªŒè¯å‡†ç¡®ç‡&#39;) plt.legend() plt.tight_layout() plt.show() ğŸš€ å®é™…é¡¹ç›®ï¼šæˆ¿ä»·é¢„æµ‹ å®Œæ•´é¡¹ç›®ä»£ç  import tensorflow as tf import numpy as np import pandas as pd from sklearn.model_selection import train_test_split from sklearn.preprocessing import StandardScaler # ç”Ÿæˆæ¨¡æ‹Ÿæˆ¿ä»·æ•°æ® np.random.seed(42) n_samples = 1000 # ç‰¹å¾ï¼šé¢ç§¯ã€æˆ¿é—´æ•°ã€å¹´é¾„ã€è·ç¦»å¸‚ä¸­å¿ƒè·ç¦» areas = np.random.normal(100, 20, n_samples) # å¹³æ–¹ç±³ rooms = np.random.randint(1, 6, n_samples) # æˆ¿é—´æ•° ages = np.random.randint(0, 50, n_samples) # æˆ¿å±‹å¹´é¾„ distances = np.random.normal(10, 3, n_samples) # è·ç¦»å¸‚ä¸­å¿ƒï¼ˆå…¬é‡Œï¼‰ # ç›®æ ‡ï¼šæˆ¿ä»·ï¼ˆä¸‡å…ƒï¼‰ prices = 50 &#43; 0.8 * areas &#43; 10 * rooms - 0.5 * ages - 2 * distances &#43; np.random.normal(0, 10, n_samples) # åˆ›å»ºDataFrame data = pd.DataFrame({ &#39;area&#39;: areas, &#39;rooms&#39;: rooms, &#39;age&#39;: ages, &#39;distance&#39;: distances, &#39;price&#39;: prices }) # æ•°æ®é¢„å¤„ç† features = [&#39;area&#39;, &#39;rooms&#39;, &#39;age&#39;, &#39;distance&#39;] X = data[features].values y = data[&#39;price&#39;].values # æ ‡å‡†åŒ–ç‰¹å¾ scaler = StandardScaler() X_scaled = scaler.fit_transform(X) # åˆ†å‰²æ•°æ®é›† X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42) # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(4,)), tf.keras.layers.Dense(32, activation=&#39;relu&#39;), tf.keras.layers.Dense(16, activation=&#39;relu&#39;), tf.keras.layers.Dense(1) # å›å½’é—®é¢˜ï¼Œè¾“å‡ºå±‚æ— æ¿€æ´»å‡½æ•° ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;adam&#39;, loss=&#39;mse&#39;, metrics=[&#39;mae&#39;, &#39;mse&#39;] ) # è®­ç»ƒæ¨¡å‹ history = model.fit( X_train, y_train, batch_size=32, epochs=100, validation_split=0.2, callbacks=[ tf.keras.callbacks.EarlyStopping(patience=10, restore_best_weights=True), tf.keras.callbacks.ReduceLROnPlateau(factor=0.5, patience=5) ], verbose=1 ) # è¯„ä¼°æ¨¡å‹ test_loss, test_mae, test_mse = model.evaluate(X_test, y_test, verbose=0) print(f&#34;æµ‹è¯•é›†MAE: {test_mae:.2f}ä¸‡å…ƒ&#34;) print(f&#34;æµ‹è¯•é›†MSE: {test_mse:.2f}ä¸‡å…ƒÂ²&#34;) # é¢„æµ‹ predictions = model.predict(X_test[:5]) print(&#34;\né¢„æµ‹ç»“æœ:&#34;) for i in range(5): print(f&#34;çœŸå®ä»·æ ¼: {y_test[i]:.2f}ä¸‡å…ƒ, é¢„æµ‹ä»·æ ¼: {predictions[i][0]:.2f}ä¸‡å…ƒ&#34;) # ä¿å­˜æ¨¡å‹ model.save(&#39;house_price_model.h5&#39;) print(&#34;\næ¨¡å‹å·²ä¿å­˜ä¸º &#39;house_price_model.h5&#39;&#34;) ğŸ¯ æœ€ä½³å®è·µ ä»£ç ç»„ç»‡ # æ¨èçš„é¡¹ç›®ç»“æ„ house_price_prediction/ â”œâ”€â”€ data/ â”‚ â”œâ”€â”€ raw/ â”‚ â””â”€â”€ processed/ â”œâ”€â”€ models/ â”‚ â””â”€â”€ saved_models/ â”œâ”€â”€ notebooks/ â”‚ â””â”€â”€ exploration.ipynb â”œâ”€â”€ src/ â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ data_preprocessing.py â”‚ â”œâ”€â”€ model.py â”‚ â””â”€â”€ train.py â”œâ”€â”€ config/ â”‚ â””â”€â”€ config.yaml â””â”€â”€ requirements.txt è°ƒè¯•æŠ€å·§ # å¯ç”¨TensorFlowè°ƒè¯• import os os.environ[&#39;TF_CPP_MIN_LOG_LEVEL&#39;] = &#39;2&#39; # å‡å°‘è­¦å‘Šä¿¡æ¯ # æ£€æŸ¥æ¨¡å‹ç»“æ„ model.summary() # æ£€æŸ¥å¼ é‡å½¢çŠ¶ print(f&#34;è¾“å…¥å½¢çŠ¶: {x_train.shape}&#34;) print(f&#34;è¾“å‡ºå½¢çŠ¶: {model.predict(x_train[:1]).shape}&#34;) # ä½¿ç”¨tf.debugging x = tf.constant([1, 2, 3]) tf.debugging.assert_shapes([ (x, (&#39;N&#39;,)), # æ–­è¨€xçš„å½¢çŠ¶ ]) ğŸ“š å­¦ä¹ èµ„æº å®˜æ–¹æ•™ç¨‹ TensorFlowå®˜æ–¹æ•™ç¨‹ Kerasæ–‡æ¡£ TensorFlow 2.0å¿«é€Ÿå…¥é—¨ å´æ©è¾¾è¯¾ç¨‹ æ·±åº¦å­¦ä¹ è¯¾ç¨‹ä¸­å…³äºTensorFlowçš„éƒ¨åˆ† å®è·µé¡¹ç›® TensorFlow Examples Kaggleç«èµ› Google Colab ğŸ”§ å¸¸è§é—®é¢˜ GPUå†…å­˜ä¸è¶³ # é™åˆ¶GPUå†…å­˜ä½¿ç”¨ gpus = tf.config.experimental.list_physical_devices(&#39;GPU&#39;) if gpus: try: for gpu in gpus: tf.config.experimental.set_memory_growth(gpu, True) except RuntimeError as e: print(e) æ¨¡å‹ä¸æ”¶æ•› # è°ƒæ•´å­¦ä¹ ç‡ optimizer = tf.keras.optimizers.Adam(learning_rate=0.001) # ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦ lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay( initial_learning_rate=0.001, decay_steps=1000, decay_rate=0.9 ) optimizer = tf.keras.optimizers.Adam(learning_rate=lr_schedule) æ•°æ®é¢„å¤„ç† # æ­£ç¡®çš„æ•°æ®é¢„å¤„ç†æµç¨‹ def preprocess_data(X, y): # 1. å¤„ç†ç¼ºå¤±å€¼ # 2. ç‰¹å¾ç¼©æ”¾ scaler = StandardScaler() X_scaled = scaler.fit_transform(X) # 3. åˆ†å‰²æ•°æ®é›† X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2) return X_train, X_test, y_train, y_test, scaler æœ€è¿‘æ›´æ–°: {{ .Lastmod.Format â€œ2006-01-02â€ }}">

    <meta property="og:url" content="http://localhost:1313/wiki/deep_learning/tensorflow/starter/">
  <meta property="og:site_name" content="Yaku Makki">
  <meta property="og:title" content="TensorFlowåŸºç¡€æ•™ç¨‹">
  <meta property="og:description" content="TensorFlowåŸºç¡€æ•™ç¨‹ æœ¬æ•™ç¨‹å°†ä»é›¶å¼€å§‹ä»‹ç»TensorFlowçš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬ç¯å¢ƒæ­å»ºã€åŸºæœ¬æ¦‚å¿µã€ç®€å•æ¨¡å‹æ„å»ºå’Œè®­ç»ƒã€‚é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å°†èƒ½å¤Ÿä½¿ç”¨TensorFlowæ„å»ºå’Œè®­ç»ƒåŸºæœ¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚
ğŸ› ï¸ ç¯å¢ƒæ­å»º å®‰è£…TensorFlow # CPUç‰ˆæœ¬ pip install tensorflow # GPUç‰ˆæœ¬ï¼ˆéœ€è¦CUDAæ”¯æŒï¼‰ pip install tensorflow[and-cuda] # éªŒè¯å®‰è£… python -c &#34;import tensorflow as tf; print(tf.config.list_physical_devices(&#39;GPU&#39; if tf.test.is_gpu_available() else &#39;CPU&#39;))&#34; æ¨èå¼€å‘ç¯å¢ƒ # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ conda create -n tf_env python=3.9 conda activate tf_env # å®‰è£…TensorFlowå’Œç›¸å…³ä¾èµ– pip install tensorflow numpy matplotlib jupyter pandas scikit-learn # å¯åŠ¨Jupyter Notebook jupyter notebook ğŸ¯ åŸºç¡€æ¦‚å¿µ Hello TensorFlow import tensorflow as tf # æ‰“å°TensorFlowç‰ˆæœ¬ print(f&#34;TensorFlowç‰ˆæœ¬: {tf.__version__}&#34;) # åˆ›å»ºå¸¸é‡å¼ é‡ hello = tf.constant(&#34;Hello, TensorFlow!&#34;) print(f&#34;å¸¸é‡: {hello.numpy()}&#34;) # åŸºæœ¬è¿ç®— a = tf.constant(5) b = tf.constant(3) print(f&#34;5 &#43; 3 = {tf.add(a, b).numpy()}&#34;) print(f&#34;5 * 3 = {tf.multiply(a, b).numpy()}&#34;) å¼ é‡æ“ä½œ import tensorflow as tf import numpy as np # åˆ›å»ºä¸åŒç±»å‹çš„å¼ é‡ scalar = tf.constant(42) # æ ‡é‡ vector = tf.constant([1, 2, 3, 4, 5]) # å‘é‡ matrix = tf.constant([[1, 2], [3, 4], [5, 6]]) # çŸ©é˜µ tensor_3d = tf.constant(np.random.rand(2, 3, 4)) # ä¸‰ç»´å¼ é‡ print(f&#34;æ ‡é‡å½¢çŠ¶: {scalar.shape}&#34;) print(f&#34;å‘é‡å½¢çŠ¶: {vector.shape}&#34;) print(f&#34;çŸ©é˜µå½¢çŠ¶: {matrix.shape}&#34;) print(f&#34;ä¸‰ç»´å¼ é‡å½¢çŠ¶: {tensor_3d.shape}&#34;) # å¼ é‡è¿ç®— x = tf.constant([1, 2, 3, 4, 5]) y = tf.constant([6, 7, 8, 9, 10]) # å…ƒç´ çº§è¿ç®— print(f&#34;x &#43; y = {tf.add(x, y).numpy()}&#34;) print(f&#34;x * y = {tf.multiply(x, y).numpy()}&#34;) # å¹¿æ’­æœºåˆ¶ matrix = tf.constant([[1, 2], [3, 4]]) vector = tf.constant([5, 6]) print(f&#34;çŸ©é˜µ &#43; å‘é‡å¹¿æ’­ç»“æœ:\n{tf.add(matrix, vector).numpy()}&#34;) ğŸ—ï¸ ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ çº¿æ€§å›å½’æ¨¡å‹ import tensorflow as tf import numpy as np import matplotlib.pyplot as plt # ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ® np.random.seed(42) X = np.random.rand(100, 1) * 10 y = 2 * X &#43; 1 &#43; np.random.randn(100, 1) * 0.5 # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(1, input_shape=(1,)) ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;sgd&#39;, # éšæœºæ¢¯åº¦ä¸‹é™ loss=&#39;mse&#39;, # å‡æ–¹è¯¯å·® metrics=[&#39;mae&#39;] # å¹³å‡ç»å¯¹è¯¯å·® ) # æ¨¡å‹æ‘˜è¦ model.summary() # è®­ç»ƒæ¨¡å‹ history = model.fit(X, y, epochs=100, verbose=0) # é¢„æµ‹ y_pred = model.predict(X) # å¯è§†åŒ–ç»“æœ plt.figure(figsize=(12, 4)) plt.subplot(1, 2, 1) plt.scatter(X, y, alpha=0.5, label=&#39;çœŸå®æ•°æ®&#39;) plt.plot(X, y_pred, color=&#39;red&#39;, label=&#39;é¢„æµ‹ç»“æœ&#39;) plt.xlabel(&#39;X&#39;) plt.ylabel(&#39;y&#39;) plt.title(&#39;çº¿æ€§å›å½’ç»“æœ&#39;) plt.legend() plt.subplot(1, 2, 2) plt.plot(history.history[&#39;loss&#39;]) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Loss&#39;) plt.title(&#39;è®­ç»ƒæŸå¤±æ›²çº¿&#39;) plt.tight_layout() plt.show() print(f&#34;æ¨¡å‹æƒé‡: {model.weights[0].numpy().flatten()}&#34;) print(f&#34;æ¨¡å‹åç½®: {model.weights[1].numpy()}&#34;) åˆ†ç±»æ¨¡å‹ - MNISTæ‰‹å†™æ•°å­—è¯†åˆ« import tensorflow as tf from tensorflow.keras.datasets import mnist from tensorflow.keras.utils import to_categorical # åŠ è½½MNISTæ•°æ®é›† (x_train, y_train), (x_test, y_test) = mnist.load_data() # æ•°æ®é¢„å¤„ç† x_train = x_train.reshape(-1, 784) / 255.0 # å±•å¹³å¹¶å½’ä¸€åŒ– x_test = x_test.reshape(-1, 784) / 255.0 y_train = to_categorical(y_train, 10) # one-hotç¼–ç  y_test = to_categorical(y_test, 10) # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(128, activation=&#39;relu&#39;, input_shape=(784,)), tf.keras.layers.Dropout(0.2), # Dropouté˜²æ­¢è¿‡æ‹Ÿåˆ tf.keras.layers.Dense(64, activation=&#39;relu&#39;), tf.keras.layers.Dense(10, activation=&#39;softmax&#39;) # è¾“å‡ºå±‚ ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;adam&#39;, # Adamä¼˜åŒ–å™¨ loss=&#39;categorical_crossentropy&#39;, # äº¤å‰ç†µæŸå¤± metrics=[&#39;accuracy&#39;] # å‡†ç¡®ç‡ ) # è®­ç»ƒæ¨¡å‹ history = model.fit( x_train, y_train, batch_size=128, epochs=10, validation_split=0.1, # éªŒè¯é›† verbose=1 ) # è¯„ä¼°æ¨¡å‹ test_loss, test_acc = model.evaluate(x_test, y_test, verbose=0) print(f&#34;æµ‹è¯•é›†å‡†ç¡®ç‡: {test_acc:.4f}&#34;) # é¢„æµ‹ predictions = model.predict(x_test[:5]) predicted_labels = tf.argmax(predictions, axis=1).numpy() true_labels = tf.argmax(y_test[:5], axis=1).numpy() print(&#34;é¢„æµ‹ç»“æœ:&#34;, predicted_labels) print(&#34;çœŸå®æ ‡ç­¾:&#34;, true_labels) ğŸ“Š æ•°æ®å¤„ç† ä½¿ç”¨tf.data API import tensorflow as tf import numpy as np # åˆ›å»ºæ•°æ®é›† def create_dataset(): # ç”Ÿæˆéšæœºæ•°æ® X = np.random.rand(1000, 10) y = np.random.randint(0, 2, 1000) # åˆ›å»ºtf.data.Dataset dataset = tf.data.Dataset.from_tensor_slices((X, y)) # æ•°æ®é¢„å¤„ç† def preprocess(x, y): # å½’ä¸€åŒ– x = (x - tf.reduce_mean(x)) / tf.math.reduce_std(x) return x, y # åº”ç”¨é¢„å¤„ç† dataset = dataset.map(preprocess) # æ‰“ä¹±å’Œæ‰¹å¤„ç† dataset = dataset.shuffle(buffer_size=100) dataset = dataset.batch(32) # é‡å¤å’Œé¢„å– dataset = dataset.repeat() dataset = dataset.prefetch(tf.data.AUTOTUNE) return dataset # ä½¿ç”¨æ•°æ®é›†è®­ç»ƒ dataset = create_dataset() model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(32, activation=&#39;relu&#39;), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) model.compile(optimizer=&#39;adam&#39;, loss=&#39;binary_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) # è®­ç»ƒ model.fit(dataset, epochs=5, steps_per_epoch=10) å›¾åƒæ•°æ®å¢å¼º from tensorflow.keras.preprocessing.image import ImageDataGenerator # åˆ›å»ºå›¾åƒæ•°æ®ç”Ÿæˆå™¨ datagen = ImageDataGenerator( rotation_range=20, # éšæœºæ—‹è½¬è§’åº¦ width_shift_range=0.1, # æ°´å¹³å¹³ç§» height_shift_range=0.1, # å‚ç›´å¹³ç§» shear_range=0.1, # å‰ªåˆ‡å˜æ¢ zoom_range=0.1, # ç¼©æ”¾ horizontal_flip=True, # æ°´å¹³ç¿»è½¬ fill_mode=&#39;nearest&#39; # å¡«å……æ¨¡å¼ ) # åº”ç”¨æ•°æ®å¢å¼º # datagen.fit(x_train) # å¦‚æœéœ€è¦çš„è¯ # enhanced_data = datagen.flow(x_train, y_train, batch_size=32) ğŸ¨ è‡ªå®šä¹‰æ¨¡å‹å’Œå±‚ è‡ªå®šä¹‰å±‚ import tensorflow as tf class CustomDense(tf.keras.layers.Layer): def __init__(self, units, activation=None, **kwargs): super(CustomDense, self).__init__(**kwargs) self.units = units self.activation = tf.keras.activations.get(activation) def build(self, input_shape): # åˆ›å»ºæƒé‡ self.w = self.add_weight( name=&#39;kernel&#39;, shape=(input_shape[-1], self.units), initializer=&#39;glorot_uniform&#39;, trainable=True ) self.b = self.add_weight( name=&#39;bias&#39;, shape=(self.units,), initializer=&#39;zeros&#39;, trainable=True ) def call(self, inputs): # å‰å‘ä¼ æ’­ output = tf.matmul(inputs, self.w) &#43; self.b if self.activation is not None: output = self.activation(output) return output def get_config(self): # åºåˆ—åŒ–é…ç½® config = super(CustomDense, self).get_config() config.update({ &#39;units&#39;: self.units, &#39;activation&#39;: tf.keras.activations.serialize(self.activation) }) return config # ä½¿ç”¨è‡ªå®šä¹‰å±‚ model = tf.keras.Sequential([ CustomDense(128, activation=&#39;relu&#39;, input_shape=(784,)), CustomDense(64, activation=&#39;relu&#39;), CustomDense(10, activation=&#39;softmax&#39;) ]) è‡ªå®šä¹‰æ¨¡å‹ class CustomModel(tf.keras.Model): def __init__(self, num_classes): super(CustomModel, self).__init__() self.dense1 = tf.keras.layers.Dense(128, activation=&#39;relu&#39;) self.dense2 = tf.keras.layers.Dense(64, activation=&#39;relu&#39;) self.dense3 = tf.keras.layers.Dense(num_classes, activation=&#39;softmax&#39;) self.dropout = tf.keras.layers.Dropout(0.2) def call(self, inputs, training=False): x = self.dense1(inputs) x = self.dropout(x, training=training) x = self.dense2(x) x = self.dropout(x, training=training) return self.dense3(x) # ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹ model = CustomModel(num_classes=10) model.compile(optimizer=&#39;adam&#39;, loss=&#39;sparse_categorical_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) ğŸ”§ æ¨¡å‹ä¿å­˜å’ŒåŠ è½½ ä¿å­˜å’ŒåŠ è½½æ¨¡å‹ import tensorflow as tf # æ„å»ºå’Œè®­ç»ƒæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) model.compile(optimizer=&#39;adam&#39;, loss=&#39;binary_crossentropy&#39;, metrics=[&#39;accuracy&#39;]) # è®­ç»ƒæ¨¡å‹ï¼ˆè¿™é‡Œä½¿ç”¨éšæœºæ•°æ®ä½œä¸ºç¤ºä¾‹ï¼‰ import numpy as np X_train = np.random.rand(100, 10) y_train = np.random.randint(0, 2, 100) model.fit(X_train, y_train, epochs=5, verbose=0) # ä¿å­˜å®Œæ•´æ¨¡å‹ model.save(&#39;my_model.h5&#39;) # HDF5æ ¼å¼ model.save(&#39;my_model&#39;) # TensorFlow SavedModelæ ¼å¼ # åŠ è½½æ¨¡å‹ loaded_model_h5 = tf.keras.models.load_model(&#39;my_model.h5&#39;) loaded_model = tf.keras.models.load_model(&#39;my_model&#39;) # æ¯”è¾ƒé¢„æµ‹ç»“æœ test_data = np.random.rand(5, 10) original_pred = model.predict(test_data) loaded_pred = loaded_model.predict(test_data) print(f&#34;é¢„æµ‹ç»“æœä¸€è‡´: {np.allclose(original_pred, loaded_pred)}&#34;) ä¿å­˜å’ŒåŠ è½½æƒé‡ # ä¿å­˜æ¨¡å‹æƒé‡ model.save_weights(&#39;model_weights.h5&#39;) # åˆ›å»ºç›¸åŒæ¶æ„çš„æ–°æ¨¡å‹ new_model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(10,)), tf.keras.layers.Dense(1, activation=&#39;sigmoid&#39;) ]) # åŠ è½½æƒé‡ new_model.load_weights(&#39;model_weights.h5&#39;) # éªŒè¯æƒé‡æ˜¯å¦ç›¸åŒ original_weights = model.get_weights() loaded_weights = new_model.get_weights() for i, (orig, loaded) in enumerate(zip(original_weights, loaded_weights)): print(f&#34;æƒé‡{i}ä¸€è‡´: {np.allclose(orig, loaded)}&#34;) ğŸ“ˆ æ¨¡å‹è¯„ä¼°å’Œå¯è§†åŒ– è¯„ä¼°æŒ‡æ ‡ from sklearn.metrics import classification_report, confusion_matrix import seaborn as sns # é¢„æµ‹æµ‹è¯•é›† y_pred = model.predict(x_test) y_pred_classes = tf.argmax(y_pred, axis=1).numpy() y_true = tf.argmax(y_test, axis=1).numpy() # åˆ†ç±»æŠ¥å‘Š print(&#34;åˆ†ç±»æŠ¥å‘Š:&#34;) print(classification_report(y_true, y_pred_classes)) # æ··æ·†çŸ©é˜µ cm = confusion_matrix(y_true, y_pred_classes) plt.figure(figsize=(10, 8)) sns.heatmap(cm, annot=True, fmt=&#39;d&#39;, cmap=&#39;Blues&#39;) plt.xlabel(&#39;é¢„æµ‹æ ‡ç­¾&#39;) plt.ylabel(&#39;çœŸå®æ ‡ç­¾&#39;) plt.title(&#39;æ··æ·†çŸ©é˜µ&#39;) plt.show() è®­ç»ƒå†å²å¯è§†åŒ– import matplotlib.pyplot as plt # è®­ç»ƒå†å² history = model.fit(x_train, y_train, validation_data=(x_val, y_val), epochs=20) # ç»˜åˆ¶è®­ç»ƒæ›²çº¿ plt.figure(figsize=(12, 4)) # æŸå¤±æ›²çº¿ plt.subplot(1, 2, 1) plt.plot(history.history[&#39;loss&#39;], label=&#39;è®­ç»ƒæŸå¤±&#39;) plt.plot(history.history[&#39;val_loss&#39;], label=&#39;éªŒè¯æŸå¤±&#39;) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Loss&#39;) plt.title(&#39;è®­ç»ƒå’ŒéªŒè¯æŸå¤±&#39;) plt.legend() # å‡†ç¡®ç‡æ›²çº¿ plt.subplot(1, 2, 2) plt.plot(history.history[&#39;accuracy&#39;], label=&#39;è®­ç»ƒå‡†ç¡®ç‡&#39;) plt.plot(history.history[&#39;val_accuracy&#39;], label=&#39;éªŒè¯å‡†ç¡®ç‡&#39;) plt.xlabel(&#39;Epoch&#39;) plt.ylabel(&#39;Accuracy&#39;) plt.title(&#39;è®­ç»ƒå’ŒéªŒè¯å‡†ç¡®ç‡&#39;) plt.legend() plt.tight_layout() plt.show() ğŸš€ å®é™…é¡¹ç›®ï¼šæˆ¿ä»·é¢„æµ‹ å®Œæ•´é¡¹ç›®ä»£ç  import tensorflow as tf import numpy as np import pandas as pd from sklearn.model_selection import train_test_split from sklearn.preprocessing import StandardScaler # ç”Ÿæˆæ¨¡æ‹Ÿæˆ¿ä»·æ•°æ® np.random.seed(42) n_samples = 1000 # ç‰¹å¾ï¼šé¢ç§¯ã€æˆ¿é—´æ•°ã€å¹´é¾„ã€è·ç¦»å¸‚ä¸­å¿ƒè·ç¦» areas = np.random.normal(100, 20, n_samples) # å¹³æ–¹ç±³ rooms = np.random.randint(1, 6, n_samples) # æˆ¿é—´æ•° ages = np.random.randint(0, 50, n_samples) # æˆ¿å±‹å¹´é¾„ distances = np.random.normal(10, 3, n_samples) # è·ç¦»å¸‚ä¸­å¿ƒï¼ˆå…¬é‡Œï¼‰ # ç›®æ ‡ï¼šæˆ¿ä»·ï¼ˆä¸‡å…ƒï¼‰ prices = 50 &#43; 0.8 * areas &#43; 10 * rooms - 0.5 * ages - 2 * distances &#43; np.random.normal(0, 10, n_samples) # åˆ›å»ºDataFrame data = pd.DataFrame({ &#39;area&#39;: areas, &#39;rooms&#39;: rooms, &#39;age&#39;: ages, &#39;distance&#39;: distances, &#39;price&#39;: prices }) # æ•°æ®é¢„å¤„ç† features = [&#39;area&#39;, &#39;rooms&#39;, &#39;age&#39;, &#39;distance&#39;] X = data[features].values y = data[&#39;price&#39;].values # æ ‡å‡†åŒ–ç‰¹å¾ scaler = StandardScaler() X_scaled = scaler.fit_transform(X) # åˆ†å‰²æ•°æ®é›† X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42) # æ„å»ºæ¨¡å‹ model = tf.keras.Sequential([ tf.keras.layers.Dense(64, activation=&#39;relu&#39;, input_shape=(4,)), tf.keras.layers.Dense(32, activation=&#39;relu&#39;), tf.keras.layers.Dense(16, activation=&#39;relu&#39;), tf.keras.layers.Dense(1) # å›å½’é—®é¢˜ï¼Œè¾“å‡ºå±‚æ— æ¿€æ´»å‡½æ•° ]) # ç¼–è¯‘æ¨¡å‹ model.compile( optimizer=&#39;adam&#39;, loss=&#39;mse&#39;, metrics=[&#39;mae&#39;, &#39;mse&#39;] ) # è®­ç»ƒæ¨¡å‹ history = model.fit( X_train, y_train, batch_size=32, epochs=100, validation_split=0.2, callbacks=[ tf.keras.callbacks.EarlyStopping(patience=10, restore_best_weights=True), tf.keras.callbacks.ReduceLROnPlateau(factor=0.5, patience=5) ], verbose=1 ) # è¯„ä¼°æ¨¡å‹ test_loss, test_mae, test_mse = model.evaluate(X_test, y_test, verbose=0) print(f&#34;æµ‹è¯•é›†MAE: {test_mae:.2f}ä¸‡å…ƒ&#34;) print(f&#34;æµ‹è¯•é›†MSE: {test_mse:.2f}ä¸‡å…ƒÂ²&#34;) # é¢„æµ‹ predictions = model.predict(X_test[:5]) print(&#34;\né¢„æµ‹ç»“æœ:&#34;) for i in range(5): print(f&#34;çœŸå®ä»·æ ¼: {y_test[i]:.2f}ä¸‡å…ƒ, é¢„æµ‹ä»·æ ¼: {predictions[i][0]:.2f}ä¸‡å…ƒ&#34;) # ä¿å­˜æ¨¡å‹ model.save(&#39;house_price_model.h5&#39;) print(&#34;\næ¨¡å‹å·²ä¿å­˜ä¸º &#39;house_price_model.h5&#39;&#34;) ğŸ¯ æœ€ä½³å®è·µ ä»£ç ç»„ç»‡ # æ¨èçš„é¡¹ç›®ç»“æ„ house_price_prediction/ â”œâ”€â”€ data/ â”‚ â”œâ”€â”€ raw/ â”‚ â””â”€â”€ processed/ â”œâ”€â”€ models/ â”‚ â””â”€â”€ saved_models/ â”œâ”€â”€ notebooks/ â”‚ â””â”€â”€ exploration.ipynb â”œâ”€â”€ src/ â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ data_preprocessing.py â”‚ â”œâ”€â”€ model.py â”‚ â””â”€â”€ train.py â”œâ”€â”€ config/ â”‚ â””â”€â”€ config.yaml â””â”€â”€ requirements.txt è°ƒè¯•æŠ€å·§ # å¯ç”¨TensorFlowè°ƒè¯• import os os.environ[&#39;TF_CPP_MIN_LOG_LEVEL&#39;] = &#39;2&#39; # å‡å°‘è­¦å‘Šä¿¡æ¯ # æ£€æŸ¥æ¨¡å‹ç»“æ„ model.summary() # æ£€æŸ¥å¼ é‡å½¢çŠ¶ print(f&#34;è¾“å…¥å½¢çŠ¶: {x_train.shape}&#34;) print(f&#34;è¾“å‡ºå½¢çŠ¶: {model.predict(x_train[:1]).shape}&#34;) # ä½¿ç”¨tf.debugging x = tf.constant([1, 2, 3]) tf.debugging.assert_shapes([ (x, (&#39;N&#39;,)), # æ–­è¨€xçš„å½¢çŠ¶ ]) ğŸ“š å­¦ä¹ èµ„æº å®˜æ–¹æ•™ç¨‹ TensorFlowå®˜æ–¹æ•™ç¨‹ Kerasæ–‡æ¡£ TensorFlow 2.0å¿«é€Ÿå…¥é—¨ å´æ©è¾¾è¯¾ç¨‹ æ·±åº¦å­¦ä¹ è¯¾ç¨‹ä¸­å…³äºTensorFlowçš„éƒ¨åˆ† å®è·µé¡¹ç›® TensorFlow Examples Kaggleç«èµ› Google Colab ğŸ”§ å¸¸è§é—®é¢˜ GPUå†…å­˜ä¸è¶³ # é™åˆ¶GPUå†…å­˜ä½¿ç”¨ gpus = tf.config.experimental.list_physical_devices(&#39;GPU&#39;) if gpus: try: for gpu in gpus: tf.config.experimental.set_memory_growth(gpu, True) except RuntimeError as e: print(e) æ¨¡å‹ä¸æ”¶æ•› # è°ƒæ•´å­¦ä¹ ç‡ optimizer = tf.keras.optimizers.Adam(learning_rate=0.001) # ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦ lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay( initial_learning_rate=0.001, decay_steps=1000, decay_rate=0.9 ) optimizer = tf.keras.optimizers.Adam(learning_rate=lr_schedule) æ•°æ®é¢„å¤„ç† # æ­£ç¡®çš„æ•°æ®é¢„å¤„ç†æµç¨‹ def preprocess_data(X, y): # 1. å¤„ç†ç¼ºå¤±å€¼ # 2. ç‰¹å¾ç¼©æ”¾ scaler = StandardScaler() X_scaled = scaler.fit_transform(X) # 3. åˆ†å‰²æ•°æ®é›† X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2) return X_train, X_test, y_train, y_test, scaler æœ€è¿‘æ›´æ–°: {{ .Lastmod.Format â€œ2006-01-02â€ }}">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="wiki">
    <meta property="article:published_time" content="2025-10-24T21:58:35+08:00">
    <meta property="article:modified_time" content="2025-10-24T21:58:35+08:00">


  </head>
  <body class="synthwave-bg">
    <header class="app-header glass-morphism neon-border">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Yaku Makki" /></a>
      <span class="app-header-title gradient-text">Yaku Makki</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">é¦–é¡µ</a>
             | 
          
          <a class="app-header-menu-item" href="/post/">åšå®¢</a>
             | 
          
          <a class="app-header-menu-item" href="/wiki/">ç»´åŸº</a>
             | 
          
          <a class="app-header-menu-item" href="/tags/">æ ‡ç­¾</a>
             | 
          
          <a class="app-header-menu-item" href="/about/">å…³äº</a>
      </nav>
      <p>ä¸ªäººå°å·¢</p>
      <div class="app-header-social">
        
          <a href="https://github.com/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="mailto:yakumakki947@hotmail.com" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-mail" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>mail</title><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          </a>
        
          <a href="https://x.com/Makki_Yaku947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
          </a>
        
          <a href="https://www.twitch.tv/u/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-twitch" viewBox="0 0 24 24" fill="currentColor"><title>Twitch</title><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container glass-morphism glow-effect">
      <div class="floating-particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 6s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 7s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 8s;"></div>
      </div>
      
  <article class="post enhanced-card glow-effect">
    <header class="post-header">
      <h1 class ="post-title gradient-text">TensorFlowåŸºç¡€æ•™ç¨‹</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Oct 24, 2025
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          7 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="tensorflowåŸºç¡€æ•™ç¨‹">TensorFlowåŸºç¡€æ•™ç¨‹</h1>
<p>æœ¬æ•™ç¨‹å°†ä»é›¶å¼€å§‹ä»‹ç»TensorFlowçš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬ç¯å¢ƒæ­å»ºã€åŸºæœ¬æ¦‚å¿µã€ç®€å•æ¨¡å‹æ„å»ºå’Œè®­ç»ƒã€‚é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å°†èƒ½å¤Ÿä½¿ç”¨TensorFlowæ„å»ºå’Œè®­ç»ƒåŸºæœ¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</p>
<h2 id="-ç¯å¢ƒæ­å»º">ğŸ› ï¸ ç¯å¢ƒæ­å»º</h2>
<h3 id="å®‰è£…tensorflow">å®‰è£…TensorFlow</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># CPUç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span>pip install tensorflow
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># GPUç‰ˆæœ¬ï¼ˆéœ€è¦CUDAæ”¯æŒï¼‰</span>
</span></span><span style="display:flex;"><span>pip install tensorflow<span style="color:#f92672">[</span>and-cuda<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯å®‰è£…</span>
</span></span><span style="display:flex;"><span>python -c <span style="color:#e6db74">&#34;import tensorflow as tf; print(tf.config.list_physical_devices(&#39;GPU&#39; if tf.test.is_gpu_available() else &#39;CPU&#39;))&#34;</span>
</span></span></code></pre></div><h3 id="æ¨èå¼€å‘ç¯å¢ƒ">æ¨èå¼€å‘ç¯å¢ƒ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span>
</span></span><span style="display:flex;"><span>conda create -n tf_env python<span style="color:#f92672">=</span>3.9
</span></span><span style="display:flex;"><span>conda activate tf_env
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å®‰è£…TensorFlowå’Œç›¸å…³ä¾èµ–</span>
</span></span><span style="display:flex;"><span>pip install tensorflow numpy matplotlib jupyter pandas scikit-learn
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯åŠ¨Jupyter Notebook</span>
</span></span><span style="display:flex;"><span>jupyter notebook
</span></span></code></pre></div><h2 id="-åŸºç¡€æ¦‚å¿µ">ğŸ¯ åŸºç¡€æ¦‚å¿µ</h2>
<h3 id="hello-tensorflow">Hello TensorFlow</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ‰“å°TensorFlowç‰ˆæœ¬</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;TensorFlowç‰ˆæœ¬: </span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>__version__<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå¸¸é‡å¼ é‡</span>
</span></span><span style="display:flex;"><span>hello <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant(<span style="color:#e6db74">&#34;Hello, TensorFlow!&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;å¸¸é‡: </span><span style="color:#e6db74">{</span>hello<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŸºæœ¬è¿ç®—</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant(<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;5 + 3 = </span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>add(a, b)<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;5 * 3 = </span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>multiply(a, b)<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="å¼ é‡æ“ä½œ">å¼ é‡æ“ä½œ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºä¸åŒç±»å‹çš„å¼ é‡</span>
</span></span><span style="display:flex;"><span>scalar <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant(<span style="color:#ae81ff">42</span>)  <span style="color:#75715e"># æ ‡é‡</span>
</span></span><span style="display:flex;"><span>vector <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])  <span style="color:#75715e"># å‘é‡</span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]])  <span style="color:#75715e"># çŸ©é˜µ</span>
</span></span><span style="display:flex;"><span>tensor_3d <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant(np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>))  <span style="color:#75715e"># ä¸‰ç»´å¼ é‡</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ ‡é‡å½¢çŠ¶: </span><span style="color:#e6db74">{</span>scalar<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;å‘é‡å½¢çŠ¶: </span><span style="color:#e6db74">{</span>vector<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;çŸ©é˜µå½¢çŠ¶: </span><span style="color:#e6db74">{</span>matrix<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ä¸‰ç»´å¼ é‡å½¢çŠ¶: </span><span style="color:#e6db74">{</span>tensor_3d<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¼ é‡è¿ç®—</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å…ƒç´ çº§è¿ç®—</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;x + y = </span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>add(x, y)<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;x * y = </span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>multiply(x, y)<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¹¿æ’­æœºåˆ¶</span>
</span></span><span style="display:flex;"><span>matrix <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]])
</span></span><span style="display:flex;"><span>vector <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;çŸ©é˜µ + å‘é‡å¹¿æ’­ç»“æœ:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{</span>tf<span style="color:#f92672">.</span>add(matrix, vector)<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="-ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ">ğŸ—ï¸ ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ</h2>
<h3 id="çº¿æ€§å›å½’æ¨¡å‹">çº¿æ€§å›å½’æ¨¡å‹</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> X <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randn(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">1</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1</span>,))
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(
</span></span><span style="display:flex;"><span>    optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sgd&#39;</span>,  <span style="color:#75715e"># éšæœºæ¢¯åº¦ä¸‹é™</span>
</span></span><span style="display:flex;"><span>    loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mse&#39;</span>,       <span style="color:#75715e"># å‡æ–¹è¯¯å·®</span>
</span></span><span style="display:flex;"><span>    metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;mae&#39;</span>]   <span style="color:#75715e"># å¹³å‡ç»å¯¹è¯¯å·®</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¨¡å‹æ‘˜è¦</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>summary()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X, y, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>y_pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å¯è§†åŒ–ç»“æœ</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(X, y, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;çœŸå®æ•°æ®&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(X, y_pred, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;é¢„æµ‹ç»“æœ&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;X&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;y&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;çº¿æ€§å›å½’ç»“æœ&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(history<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Epoch&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Loss&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;è®­ç»ƒæŸå¤±æ›²çº¿&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ¨¡å‹æƒé‡: </span><span style="color:#e6db74">{</span>model<span style="color:#f92672">.</span>weights[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>numpy()<span style="color:#f92672">.</span>flatten()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æ¨¡å‹åç½®: </span><span style="color:#e6db74">{</span>model<span style="color:#f92672">.</span>weights[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>numpy()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="åˆ†ç±»æ¨¡å‹---mnistæ‰‹å†™æ•°å­—è¯†åˆ«">åˆ†ç±»æ¨¡å‹ - MNISTæ‰‹å†™æ•°å­—è¯†åˆ«</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.datasets <span style="color:#f92672">import</span> mnist
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> to_categorical
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½MNISTæ•°æ®é›†</span>
</span></span><span style="display:flex;"><span>(x_train, y_train), (x_test, y_test) <span style="color:#f92672">=</span> mnist<span style="color:#f92672">.</span>load_data()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®é¢„å¤„ç†</span>
</span></span><span style="display:flex;"><span>x_train <span style="color:#f92672">=</span> x_train<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">784</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">255.0</span>  <span style="color:#75715e"># å±•å¹³å¹¶å½’ä¸€åŒ–</span>
</span></span><span style="display:flex;"><span>x_test <span style="color:#f92672">=</span> x_test<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">784</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">255.0</span>
</span></span><span style="display:flex;"><span>y_train <span style="color:#f92672">=</span> to_categorical(y_train, <span style="color:#ae81ff">10</span>)  <span style="color:#75715e"># one-hotç¼–ç </span>
</span></span><span style="display:flex;"><span>y_test <span style="color:#f92672">=</span> to_categorical(y_test, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">128</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">784</span>,)),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dropout(<span style="color:#ae81ff">0.2</span>),  <span style="color:#75715e"># Dropouté˜²æ­¢è¿‡æ‹Ÿåˆ</span>
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>)  <span style="color:#75715e"># è¾“å‡ºå±‚</span>
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(
</span></span><span style="display:flex;"><span>    optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>,  <span style="color:#75715e"># Adamä¼˜åŒ–å™¨</span>
</span></span><span style="display:flex;"><span>    loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>,  <span style="color:#75715e"># äº¤å‰ç†µæŸå¤±</span>
</span></span><span style="display:flex;"><span>    metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>]  <span style="color:#75715e"># å‡†ç¡®ç‡</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(
</span></span><span style="display:flex;"><span>    x_train, y_train,
</span></span><span style="display:flex;"><span>    batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">128</span>,
</span></span><span style="display:flex;"><span>    epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>    validation_split<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,  <span style="color:#75715e"># éªŒè¯é›†</span>
</span></span><span style="display:flex;"><span>    verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¯„ä¼°æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>test_loss, test_acc <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>evaluate(x_test, y_test, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æµ‹è¯•é›†å‡†ç¡®ç‡: </span><span style="color:#e6db74">{</span>test_acc<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>predictions <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(x_test[:<span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>predicted_labels <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>argmax(predictions, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>true_labels <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>argmax(y_test[:<span style="color:#ae81ff">5</span>], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;é¢„æµ‹ç»“æœ:&#34;</span>, predicted_labels)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;çœŸå®æ ‡ç­¾:&#34;</span>, true_labels)
</span></span></code></pre></div><h2 id="-æ•°æ®å¤„ç†">ğŸ“Š æ•°æ®å¤„ç†</h2>
<h3 id="ä½¿ç”¨tfdata-api">ä½¿ç”¨tf.data API</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºæ•°æ®é›†</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_dataset</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ç”Ÿæˆéšæœºæ•°æ®</span>
</span></span><span style="display:flex;"><span>    X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">1000</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># åˆ›å»ºtf.data.Dataset</span>
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>Dataset<span style="color:#f92672">.</span>from_tensor_slices((X, y))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ•°æ®é¢„å¤„ç†</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">preprocess</span>(x, y):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å½’ä¸€åŒ–</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> (x <span style="color:#f92672">-</span> tf<span style="color:#f92672">.</span>reduce_mean(x)) <span style="color:#f92672">/</span> tf<span style="color:#f92672">.</span>math<span style="color:#f92672">.</span>reduce_std(x)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x, y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># åº”ç”¨é¢„å¤„ç†</span>
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>map(preprocess)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æ‰“ä¹±å’Œæ‰¹å¤„ç†</span>
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>shuffle(buffer_size<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>batch(<span style="color:#ae81ff">32</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># é‡å¤å’Œé¢„å–</span>
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>repeat()
</span></span><span style="display:flex;"><span>    dataset <span style="color:#f92672">=</span> dataset<span style="color:#f92672">.</span>prefetch(tf<span style="color:#f92672">.</span>data<span style="color:#f92672">.</span>AUTOTUNE)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> dataset
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨æ•°æ®é›†è®­ç»ƒ</span>
</span></span><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> create_dataset()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,)),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">32</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">1</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>)
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;binary_crossentropy&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒ</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>fit(dataset, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, steps_per_epoch<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><h3 id="å›¾åƒæ•°æ®å¢å¼º">å›¾åƒæ•°æ®å¢å¼º</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.preprocessing.image <span style="color:#f92672">import</span> ImageDataGenerator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºå›¾åƒæ•°æ®ç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span>datagen <span style="color:#f92672">=</span> ImageDataGenerator(
</span></span><span style="display:flex;"><span>    rotation_range<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>,      <span style="color:#75715e"># éšæœºæ—‹è½¬è§’åº¦</span>
</span></span><span style="display:flex;"><span>    width_shift_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,  <span style="color:#75715e"># æ°´å¹³å¹³ç§»</span>
</span></span><span style="display:flex;"><span>    height_shift_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>, <span style="color:#75715e"># å‚ç›´å¹³ç§»</span>
</span></span><span style="display:flex;"><span>    shear_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,        <span style="color:#75715e"># å‰ªåˆ‡å˜æ¢</span>
</span></span><span style="display:flex;"><span>    zoom_range<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,         <span style="color:#75715e"># ç¼©æ”¾</span>
</span></span><span style="display:flex;"><span>    horizontal_flip<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,   <span style="color:#75715e"># æ°´å¹³ç¿»è½¬</span>
</span></span><span style="display:flex;"><span>    fill_mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;nearest&#39;</span>     <span style="color:#75715e"># å¡«å……æ¨¡å¼</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åº”ç”¨æ•°æ®å¢å¼º</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># datagen.fit(x_train)  # å¦‚æœéœ€è¦çš„è¯</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># enhanced_data = datagen.flow(x_train, y_train, batch_size=32)</span>
</span></span></code></pre></div><h2 id="-è‡ªå®šä¹‰æ¨¡å‹å’Œå±‚">ğŸ¨ è‡ªå®šä¹‰æ¨¡å‹å’Œå±‚</h2>
<h3 id="è‡ªå®šä¹‰å±‚">è‡ªå®šä¹‰å±‚</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomDense</span>(tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Layer):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, units, activation<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        super(CustomDense, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>(<span style="color:#f92672">**</span>kwargs)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>units <span style="color:#f92672">=</span> units
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>activation <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>activations<span style="color:#f92672">.</span>get(activation)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build</span>(self, input_shape):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åˆ›å»ºæƒé‡</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>add_weight(
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;kernel&#39;</span>,
</span></span><span style="display:flex;"><span>            shape<span style="color:#f92672">=</span>(input_shape[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], self<span style="color:#f92672">.</span>units),
</span></span><span style="display:flex;"><span>            initializer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;glorot_uniform&#39;</span>,
</span></span><span style="display:flex;"><span>            trainable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>add_weight(
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bias&#39;</span>,
</span></span><span style="display:flex;"><span>            shape<span style="color:#f92672">=</span>(self<span style="color:#f92672">.</span>units,),
</span></span><span style="display:flex;"><span>            initializer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;zeros&#39;</span>,
</span></span><span style="display:flex;"><span>            trainable<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">call</span>(self, inputs):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># å‰å‘ä¼ æ’­</span>
</span></span><span style="display:flex;"><span>        output <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>matmul(inputs, self<span style="color:#f92672">.</span>w) <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>activation <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            output <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>activation(output)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_config</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åºåˆ—åŒ–é…ç½®</span>
</span></span><span style="display:flex;"><span>        config <span style="color:#f92672">=</span> super(CustomDense, self)<span style="color:#f92672">.</span>get_config()
</span></span><span style="display:flex;"><span>        config<span style="color:#f92672">.</span>update({
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;units&#39;</span>: self<span style="color:#f92672">.</span>units,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;activation&#39;</span>: tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>activations<span style="color:#f92672">.</span>serialize(self<span style="color:#f92672">.</span>activation)
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> config
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨è‡ªå®šä¹‰å±‚</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    CustomDense(<span style="color:#ae81ff">128</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">784</span>,)),
</span></span><span style="display:flex;"><span>    CustomDense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>),
</span></span><span style="display:flex;"><span>    CustomDense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>)
</span></span><span style="display:flex;"><span>])
</span></span></code></pre></div><h3 id="è‡ªå®šä¹‰æ¨¡å‹">è‡ªå®šä¹‰æ¨¡å‹</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomModel</span>(tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Model):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, num_classes):
</span></span><span style="display:flex;"><span>        super(CustomModel, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dense1 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">128</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dense2 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dense3 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(num_classes, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dropout <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dropout(<span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">call</span>(self, inputs, training<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dense1(inputs)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dropout(x, training<span style="color:#f92672">=</span>training)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dense2(x)
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dropout(x, training<span style="color:#f92672">=</span>training)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>dense3(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> CustomModel(num_classes<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sparse_categorical_crossentropy&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])
</span></span></code></pre></div><h2 id="-æ¨¡å‹ä¿å­˜å’ŒåŠ è½½">ğŸ”§ æ¨¡å‹ä¿å­˜å’ŒåŠ è½½</h2>
<h3 id="ä¿å­˜å’ŒåŠ è½½æ¨¡å‹">ä¿å­˜å’ŒåŠ è½½æ¨¡å‹</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºå’Œè®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,)),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">1</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>)
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;binary_crossentropy&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒæ¨¡å‹ï¼ˆè¿™é‡Œä½¿ç”¨éšæœºæ•°æ®ä½œä¸ºç¤ºä¾‹ï¼‰</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>X_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>y_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>fit(X_train, y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¿å­˜å®Œæ•´æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;my_model.h5&#39;</span>)  <span style="color:#75715e"># HDF5æ ¼å¼</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;my_model&#39;</span>)     <span style="color:#75715e"># TensorFlow SavedModelæ ¼å¼</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>loaded_model_h5 <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>load_model(<span style="color:#e6db74">&#39;my_model.h5&#39;</span>)
</span></span><span style="display:flex;"><span>loaded_model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>load_model(<span style="color:#e6db74">&#39;my_model&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ¯”è¾ƒé¢„æµ‹ç»“æœ</span>
</span></span><span style="display:flex;"><span>test_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>original_pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(test_data)
</span></span><span style="display:flex;"><span>loaded_pred <span style="color:#f92672">=</span> loaded_model<span style="color:#f92672">.</span>predict(test_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;é¢„æµ‹ç»“æœä¸€è‡´: </span><span style="color:#e6db74">{</span>np<span style="color:#f92672">.</span>allclose(original_pred, loaded_pred)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h3 id="ä¿å­˜å’ŒåŠ è½½æƒé‡">ä¿å­˜å’ŒåŠ è½½æƒé‡</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ä¿å­˜æ¨¡å‹æƒé‡</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>save_weights(<span style="color:#e6db74">&#39;model_weights.h5&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºç›¸åŒæ¶æ„çš„æ–°æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>new_model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,)),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">1</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>)
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½æƒé‡</span>
</span></span><span style="display:flex;"><span>new_model<span style="color:#f92672">.</span>load_weights(<span style="color:#e6db74">&#39;model_weights.h5&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># éªŒè¯æƒé‡æ˜¯å¦ç›¸åŒ</span>
</span></span><span style="display:flex;"><span>original_weights <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>get_weights()
</span></span><span style="display:flex;"><span>loaded_weights <span style="color:#f92672">=</span> new_model<span style="color:#f92672">.</span>get_weights()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, (orig, loaded) <span style="color:#f92672">in</span> enumerate(zip(original_weights, loaded_weights)):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æƒé‡</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">ä¸€è‡´: </span><span style="color:#e6db74">{</span>np<span style="color:#f92672">.</span>allclose(orig, loaded)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="-æ¨¡å‹è¯„ä¼°å’Œå¯è§†åŒ–">ğŸ“ˆ æ¨¡å‹è¯„ä¼°å’Œå¯è§†åŒ–</h2>
<h3 id="è¯„ä¼°æŒ‡æ ‡">è¯„ä¼°æŒ‡æ ‡</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report, confusion_matrix
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é¢„æµ‹æµ‹è¯•é›†</span>
</span></span><span style="display:flex;"><span>y_pred <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(x_test)
</span></span><span style="display:flex;"><span>y_pred_classes <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>argmax(y_pred, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>y_true <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>argmax(y_test, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ†ç±»æŠ¥å‘Š</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;åˆ†ç±»æŠ¥å‘Š:&#34;</span>)
</span></span><span style="display:flex;"><span>print(classification_report(y_true, y_pred_classes))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ··æ·†çŸ©é˜µ</span>
</span></span><span style="display:flex;"><span>cm <span style="color:#f92672">=</span> confusion_matrix(y_true, y_pred_classes)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;d&#39;</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Blues&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;é¢„æµ‹æ ‡ç­¾&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;çœŸå®æ ‡ç­¾&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;æ··æ·†çŸ©é˜µ&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="è®­ç»ƒå†å²å¯è§†åŒ–">è®­ç»ƒå†å²å¯è§†åŒ–</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒå†å²</span>
</span></span><span style="display:flex;"><span>history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x_train, y_train, validation_data<span style="color:#f92672">=</span>(x_val, y_val), epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç»˜åˆ¶è®­ç»ƒæ›²çº¿</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŸå¤±æ›²çº¿</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(history<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;è®­ç»ƒæŸå¤±&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(history<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;val_loss&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;éªŒè¯æŸå¤±&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Epoch&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Loss&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;è®­ç»ƒå’ŒéªŒè¯æŸå¤±&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># å‡†ç¡®ç‡æ›²çº¿</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(history<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;accuracy&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;è®­ç»ƒå‡†ç¡®ç‡&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(history<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;val_accuracy&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;éªŒè¯å‡†ç¡®ç‡&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Epoch&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;è®­ç»ƒå’ŒéªŒè¯å‡†ç¡®ç‡&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="-å®é™…é¡¹ç›®æˆ¿ä»·é¢„æµ‹">ğŸš€ å®é™…é¡¹ç›®ï¼šæˆ¿ä»·é¢„æµ‹</h2>
<h3 id="å®Œæ•´é¡¹ç›®ä»£ç ">å®Œæ•´é¡¹ç›®ä»£ç </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> tensorflow <span style="color:#66d9ef">as</span> tf
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆæ¨¡æ‹Ÿæˆ¿ä»·æ•°æ®</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>n_samples <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç‰¹å¾ï¼šé¢ç§¯ã€æˆ¿é—´æ•°ã€å¹´é¾„ã€è·ç¦»å¸‚ä¸­å¿ƒè·ç¦»</span>
</span></span><span style="display:flex;"><span>areas <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">20</span>, n_samples)  <span style="color:#75715e"># å¹³æ–¹ç±³</span>
</span></span><span style="display:flex;"><span>rooms <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>, n_samples)     <span style="color:#75715e"># æˆ¿é—´æ•°</span>
</span></span><span style="display:flex;"><span>ages <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>, n_samples)     <span style="color:#75715e"># æˆ¿å±‹å¹´é¾„</span>
</span></span><span style="display:flex;"><span>distances <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, n_samples) <span style="color:#75715e"># è·ç¦»å¸‚ä¸­å¿ƒï¼ˆå…¬é‡Œï¼‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç›®æ ‡ï¼šæˆ¿ä»·ï¼ˆä¸‡å…ƒï¼‰</span>
</span></span><span style="display:flex;"><span>prices <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.8</span> <span style="color:#f92672">*</span> areas <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> rooms <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> ages <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> distances <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, n_samples)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ›å»ºDataFrame</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;area&#39;</span>: areas,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;rooms&#39;</span>: rooms,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;age&#39;</span>: ages,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;distance&#39;</span>: distances,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;price&#39;</span>: prices
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®é¢„å¤„ç†</span>
</span></span><span style="display:flex;"><span>features <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;area&#39;</span>, <span style="color:#e6db74">&#39;rooms&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>, <span style="color:#e6db74">&#39;distance&#39;</span>]
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> data[features]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;price&#39;</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ ‡å‡†åŒ–ç‰¹å¾</span>
</span></span><span style="display:flex;"><span>scaler <span style="color:#f92672">=</span> StandardScaler()
</span></span><span style="display:flex;"><span>X_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ†å‰²æ•°æ®é›†</span>
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X_scaled, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ„å»ºæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>Sequential([
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">64</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">4</span>,)),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">32</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">16</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>),
</span></span><span style="display:flex;"><span>    tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>layers<span style="color:#f92672">.</span>Dense(<span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># å›å½’é—®é¢˜ï¼Œè¾“å‡ºå±‚æ— æ¿€æ´»å‡½æ•°</span>
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç¼–è¯‘æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>compile(
</span></span><span style="display:flex;"><span>    optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>,
</span></span><span style="display:flex;"><span>    loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mse&#39;</span>,
</span></span><span style="display:flex;"><span>    metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;mae&#39;</span>, <span style="color:#e6db74">&#39;mse&#39;</span>]
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style="display:flex;"><span>history <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(
</span></span><span style="display:flex;"><span>    X_train, y_train,
</span></span><span style="display:flex;"><span>    batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>,
</span></span><span style="display:flex;"><span>    epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>    validation_split<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>    callbacks<span style="color:#f92672">=</span>[
</span></span><span style="display:flex;"><span>        tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>callbacks<span style="color:#f92672">.</span>EarlyStopping(patience<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, restore_best_weights<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>),
</span></span><span style="display:flex;"><span>        tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>callbacks<span style="color:#f92672">.</span>ReduceLROnPlateau(factor<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, patience<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¯„ä¼°æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>test_loss, test_mae, test_mse <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>evaluate(X_test, y_test, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æµ‹è¯•é›†MAE: </span><span style="color:#e6db74">{</span>test_mae<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">ä¸‡å…ƒ&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;æµ‹è¯•é›†MSE: </span><span style="color:#e6db74">{</span>test_mse<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">ä¸‡å…ƒÂ²&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>predictions <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test[:<span style="color:#ae81ff">5</span>])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">é¢„æµ‹ç»“æœ:&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;çœŸå®ä»·æ ¼: </span><span style="color:#e6db74">{</span>y_test[i]<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">ä¸‡å…ƒ, é¢„æµ‹ä»·æ ¼: </span><span style="color:#e6db74">{</span>predictions[i][<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">ä¸‡å…ƒ&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä¿å­˜æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;house_price_model.h5&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">æ¨¡å‹å·²ä¿å­˜ä¸º &#39;house_price_model.h5&#39;&#34;</span>)
</span></span></code></pre></div><h2 id="-æœ€ä½³å®è·µ">ğŸ¯ æœ€ä½³å®è·µ</h2>
<h3 id="ä»£ç ç»„ç»‡">ä»£ç ç»„ç»‡</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ¨èçš„é¡¹ç›®ç»“æ„</span>
</span></span><span style="display:flex;"><span>house_price_prediction<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> data<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> raw<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> processed<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> models<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> saved_models<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> notebooks<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> exploration<span style="color:#f92672">.</span>ipynb
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> src<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> <span style="color:#a6e22e">__init__</span><span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> data_preprocessing<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> model<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> train<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”œâ”€â”€</span> config<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â”‚</span>   <span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> config<span style="color:#f92672">.</span>yaml
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">â””â”€â”€</span> requirements<span style="color:#f92672">.</span>txt
</span></span></code></pre></div><h3 id="è°ƒè¯•æŠ€å·§">è°ƒè¯•æŠ€å·§</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># å¯ç”¨TensorFlowè°ƒè¯•</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#39;TF_CPP_MIN_LOG_LEVEL&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2&#39;</span>  <span style="color:#75715e"># å‡å°‘è­¦å‘Šä¿¡æ¯</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥æ¨¡å‹ç»“æ„</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>summary()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ£€æŸ¥å¼ é‡å½¢çŠ¶</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;è¾“å…¥å½¢çŠ¶: </span><span style="color:#e6db74">{</span>x_train<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;è¾“å‡ºå½¢çŠ¶: </span><span style="color:#e6db74">{</span>model<span style="color:#f92672">.</span>predict(x_train[:<span style="color:#ae81ff">1</span>])<span style="color:#f92672">.</span>shape<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨tf.debugging</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>constant([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>tf<span style="color:#f92672">.</span>debugging<span style="color:#f92672">.</span>assert_shapes([
</span></span><span style="display:flex;"><span>    (x, (<span style="color:#e6db74">&#39;N&#39;</span>,)),  <span style="color:#75715e"># æ–­è¨€xçš„å½¢çŠ¶</span>
</span></span><span style="display:flex;"><span>])
</span></span></code></pre></div><h2 id="-å­¦ä¹ èµ„æº">ğŸ“š å­¦ä¹ èµ„æº</h2>
<h3 id="å®˜æ–¹æ•™ç¨‹">å®˜æ–¹æ•™ç¨‹</h3>
<ul>
<li><a href="https://www.tensorflow.org/tutorials">TensorFlowå®˜æ–¹æ•™ç¨‹</a></li>
<li><a href="https://keras.io/getting_started/">Kerasæ–‡æ¡£</a></li>
<li><a href="https://www.tensorflow.org/tutorials/quickstart/beginner">TensorFlow 2.0å¿«é€Ÿå…¥é—¨</a></li>
</ul>
<h3 id="å´æ©è¾¾è¯¾ç¨‹">å´æ©è¾¾è¯¾ç¨‹</h3>
<ul>
<li>æ·±åº¦å­¦ä¹ è¯¾ç¨‹ä¸­å…³äºTensorFlowçš„éƒ¨åˆ†</li>
</ul>
<h3 id="å®è·µé¡¹ç›®">å®è·µé¡¹ç›®</h3>
<ul>
<li><a href="https://github.com/tensorflow/examples">TensorFlow Examples</a></li>
<li><a href="https://www.kaggle.com/competitions">Kaggleç«èµ›</a></li>
<li><a href="https://colab.research.google.com/">Google Colab</a></li>
</ul>
<h2 id="-å¸¸è§é—®é¢˜">ğŸ”§ å¸¸è§é—®é¢˜</h2>
<h3 id="gpuå†…å­˜ä¸è¶³">GPUå†…å­˜ä¸è¶³</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># é™åˆ¶GPUå†…å­˜ä½¿ç”¨</span>
</span></span><span style="display:flex;"><span>gpus <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>config<span style="color:#f92672">.</span>experimental<span style="color:#f92672">.</span>list_physical_devices(<span style="color:#e6db74">&#39;GPU&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> gpus:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> gpu <span style="color:#f92672">in</span> gpus:
</span></span><span style="display:flex;"><span>            tf<span style="color:#f92672">.</span>config<span style="color:#f92672">.</span>experimental<span style="color:#f92672">.</span>set_memory_growth(gpu, <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">RuntimeError</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(e)
</span></span></code></pre></div><h3 id="æ¨¡å‹ä¸æ”¶æ•›">æ¨¡å‹ä¸æ”¶æ•›</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># è°ƒæ•´å­¦ä¹ ç‡</span>
</span></span><span style="display:flex;"><span>optimizer <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>optimizers<span style="color:#f92672">.</span>Adam(learning_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.001</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦</span>
</span></span><span style="display:flex;"><span>lr_schedule <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>optimizers<span style="color:#f92672">.</span>schedules<span style="color:#f92672">.</span>ExponentialDecay(
</span></span><span style="display:flex;"><span>    initial_learning_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.001</span>,
</span></span><span style="display:flex;"><span>    decay_steps<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>,
</span></span><span style="display:flex;"><span>    decay_rate<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>optimizer <span style="color:#f92672">=</span> tf<span style="color:#f92672">.</span>keras<span style="color:#f92672">.</span>optimizers<span style="color:#f92672">.</span>Adam(learning_rate<span style="color:#f92672">=</span>lr_schedule)
</span></span></code></pre></div><h3 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æ­£ç¡®çš„æ•°æ®é¢„å¤„ç†æµç¨‹</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">preprocess_data</span>(X, y):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 1. å¤„ç†ç¼ºå¤±å€¼</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 2. ç‰¹å¾ç¼©æ”¾</span>
</span></span><span style="display:flex;"><span>    scaler <span style="color:#f92672">=</span> StandardScaler()
</span></span><span style="display:flex;"><span>    X_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 3. åˆ†å‰²æ•°æ®é›†</span>
</span></span><span style="display:flex;"><span>    X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X_scaled, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> X_train, X_test, y_train, y_test, scaler
</span></span></code></pre></div><hr>
<p><em>æœ€è¿‘æ›´æ–°: {{ .Lastmod.Format &ldquo;2006-01-02&rdquo; }}</em></p>

      
      <div class="post-separator">------------------------------------------------------------------------</div>
      
    </div>
    <div class="post-footer">
      
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <div class="busuanzi-container">
        <span id="busuanzi_container_page_pv">--æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡--</span>
      </div>
      
      
      <script src="https://utteranc.es/client.js"
        repo="makkichan947/makkichan947.github.io"
        issue-term="pathname"
        label="Utterances"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
    </div>
  </article>

    </main>
  </body>
</html>
