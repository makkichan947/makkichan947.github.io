<!doctype html>
<html lang="zh">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ // Yaku Makki</title>
    <link rel="shortcut icon" href="./avatar.jpg" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.151.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Yaku Makki" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.422840b4454cb211f5b3dab61f082cdff508e88825173c31806835cb75529734.css" />
    

    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ">
  <meta name="twitter:description" content="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰æ˜¯ç”±Ian Goodfellowåœ¨2014å¹´æå‡ºçš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œé€šè¿‡å¯¹æŠ—è®­ç»ƒçš„æ–¹å¼ç”Ÿæˆé«˜è´¨é‡çš„åˆæˆæ•°æ®ï¼Œåœ¨å›¾åƒç”Ÿæˆã€é£æ ¼è¿ç§»ç­‰é¢†åŸŸå–å¾—äº†å·¨å¤§æˆåŠŸã€‚
ğŸ¯ GANåŸºæœ¬åŸç† å¯¹æŠ—è®­ç»ƒæ€æƒ³ GANçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œåˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ä¹‹é—´çš„å¯¹æŠ—è®­ç»ƒæ¥å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼š
ç”Ÿæˆå™¨Gï¼šå­¦ä¹ çœŸå®æ•°æ®åˆ†å¸ƒï¼Œç”Ÿæˆé€¼çœŸçš„å‡æ ·æœ¬ åˆ¤åˆ«å™¨Dï¼šåŒºåˆ†çœŸå®æ ·æœ¬å’Œç”Ÿæˆæ ·æœ¬ å¯¹æŠ—è¿‡ç¨‹ï¼šç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨ï¼Œåˆ¤åˆ«å™¨è¯•å›¾æ­£ç¡®è¯†åˆ« æ•°å­¦åŸºç¡€ ç”Ÿæˆå™¨ç›®æ ‡ï¼š $$\min_G \max_D V(D,G) = \mathbb{E}{x \sim p{data}}[\log D(x)] &#43; \mathbb{E}_{z \sim p_z}[\log (1 - D(G(z)))]$$
æœ€ä¼˜åˆ¤åˆ«å™¨ï¼š $$D^*(x) = \frac{p_{data}(x)}{p_{data}(x) &#43; p_g(x)}$$
ğŸ—ï¸ GANæ¶æ„è¯¦è§£ ç”Ÿæˆå™¨ç»“æ„ ç”Ÿæˆå™¨é€šå¸¸é‡‡ç”¨è§£ç å™¨å¼çš„æ¶æ„ï¼š
class Generator(nn.Module): def __init__(self, latent_dim, img_shape): super(Generator, self).__init__() self.model = nn.Sequential( # ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ nn.Linear(latent_dim, 128), nn.BatchNorm1d(128), nn.ReLU(), # ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ nn.Linear(128, 256), nn.BatchNorm1d(256), nn.ReLU(), # ç¬¬ä¸‰ä¸ªå…¨è¿æ¥å±‚ nn.Linear(256, 512), nn.BatchNorm1d(512), nn.ReLU(), # è¾“å‡ºå±‚ nn.Linear(512, int(np.prod(img_shape))), nn.Tanh() ) def forward(self, z): img = self.model(z) img = img.view(img.size(0), *img_shape) return img åˆ¤åˆ«å™¨ç»“æ„ åˆ¤åˆ«å™¨é‡‡ç”¨åˆ†ç±»å™¨æ¶æ„ï¼š">

    <meta property="og:url" content="http://localhost:1313/wiki/deep_learning/gan/">
  <meta property="og:site_name" content="Yaku Makki">
  <meta property="og:title" content="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ">
  <meta property="og:description" content="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰æ˜¯ç”±Ian Goodfellowåœ¨2014å¹´æå‡ºçš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œé€šè¿‡å¯¹æŠ—è®­ç»ƒçš„æ–¹å¼ç”Ÿæˆé«˜è´¨é‡çš„åˆæˆæ•°æ®ï¼Œåœ¨å›¾åƒç”Ÿæˆã€é£æ ¼è¿ç§»ç­‰é¢†åŸŸå–å¾—äº†å·¨å¤§æˆåŠŸã€‚
ğŸ¯ GANåŸºæœ¬åŸç† å¯¹æŠ—è®­ç»ƒæ€æƒ³ GANçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œåˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ä¹‹é—´çš„å¯¹æŠ—è®­ç»ƒæ¥å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼š
ç”Ÿæˆå™¨Gï¼šå­¦ä¹ çœŸå®æ•°æ®åˆ†å¸ƒï¼Œç”Ÿæˆé€¼çœŸçš„å‡æ ·æœ¬ åˆ¤åˆ«å™¨Dï¼šåŒºåˆ†çœŸå®æ ·æœ¬å’Œç”Ÿæˆæ ·æœ¬ å¯¹æŠ—è¿‡ç¨‹ï¼šç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨ï¼Œåˆ¤åˆ«å™¨è¯•å›¾æ­£ç¡®è¯†åˆ« æ•°å­¦åŸºç¡€ ç”Ÿæˆå™¨ç›®æ ‡ï¼š $$\min_G \max_D V(D,G) = \mathbb{E}{x \sim p{data}}[\log D(x)] &#43; \mathbb{E}_{z \sim p_z}[\log (1 - D(G(z)))]$$
æœ€ä¼˜åˆ¤åˆ«å™¨ï¼š $$D^*(x) = \frac{p_{data}(x)}{p_{data}(x) &#43; p_g(x)}$$
ğŸ—ï¸ GANæ¶æ„è¯¦è§£ ç”Ÿæˆå™¨ç»“æ„ ç”Ÿæˆå™¨é€šå¸¸é‡‡ç”¨è§£ç å™¨å¼çš„æ¶æ„ï¼š
class Generator(nn.Module): def __init__(self, latent_dim, img_shape): super(Generator, self).__init__() self.model = nn.Sequential( # ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ nn.Linear(latent_dim, 128), nn.BatchNorm1d(128), nn.ReLU(), # ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ nn.Linear(128, 256), nn.BatchNorm1d(256), nn.ReLU(), # ç¬¬ä¸‰ä¸ªå…¨è¿æ¥å±‚ nn.Linear(256, 512), nn.BatchNorm1d(512), nn.ReLU(), # è¾“å‡ºå±‚ nn.Linear(512, int(np.prod(img_shape))), nn.Tanh() ) def forward(self, z): img = self.model(z) img = img.view(img.size(0), *img_shape) return img åˆ¤åˆ«å™¨ç»“æ„ åˆ¤åˆ«å™¨é‡‡ç”¨åˆ†ç±»å™¨æ¶æ„ï¼š">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="wiki">
    <meta property="article:published_time" content="2025-10-24T21:39:04+08:00">
    <meta property="article:modified_time" content="2025-10-24T21:39:04+08:00">


  </head>
  <body class="synthwave-bg">
    <header class="app-header glass-morphism neon-border">
      <a href="/"><img class="app-header-avatar" src="/avatar.jpg" alt="Yaku Makki" /></a>
      <span class="app-header-title gradient-text">Yaku Makki</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">é¦–é¡µ</a>
             | 
          
          <a class="app-header-menu-item" href="/post/">åšå®¢</a>
             | 
          
          <a class="app-header-menu-item" href="/wiki/">ç»´åŸº</a>
             | 
          
          <a class="app-header-menu-item" href="/tags/">æ ‡ç­¾</a>
             | 
          
          <a class="app-header-menu-item" href="/about/">å…³äº</a>
      </nav>
      <p>ä¸ªäººå°å·¢</p>
      <div class="app-header-social">
        
          <a href="https://github.com/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-github" viewBox="0 0 24 24" fill="currentColor"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
          </a>
        
          <a href="mailto:yakumakki947@hotmail.com" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-mail" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>mail</title><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
          </a>
        
          <a href="https://x.com/Makki_Yaku947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
          </a>
        
          <a href="https://www.twitch.tv/u/makkichan947" target="_blank" rel="noreferrer noopener me" class="pulse-glow">
            <svg class="icon icon-brand-twitch" viewBox="0 0 24 24" fill="currentColor"><title>Twitch</title><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
          </a>
        
      </div>
    </header>
    <main class="app-container glass-morphism glow-effect">
      <div class="floating-particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 6s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 7s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 8s;"></div>
      </div>
      
  <article class="post enhanced-card glow-effect">
    <header class="post-header">
      <h1 class ="post-title gradient-text">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</h1>
      <div class="post-meta">
        <div>
          <svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
          Oct 24, 2025
        </div>
        <div>
          <svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
          4 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ</h1>
<p>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGenerative Adversarial Networks, GANï¼‰æ˜¯ç”±Ian Goodfellowåœ¨2014å¹´æå‡ºçš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œé€šè¿‡å¯¹æŠ—è®­ç»ƒçš„æ–¹å¼ç”Ÿæˆé«˜è´¨é‡çš„åˆæˆæ•°æ®ï¼Œåœ¨å›¾åƒç”Ÿæˆã€é£æ ¼è¿ç§»ç­‰é¢†åŸŸå–å¾—äº†å·¨å¤§æˆåŠŸã€‚</p>
<h2 id="-ganåŸºæœ¬åŸç†">ğŸ¯ GANåŸºæœ¬åŸç†</h2>
<h3 id="å¯¹æŠ—è®­ç»ƒæ€æƒ³">å¯¹æŠ—è®­ç»ƒæ€æƒ³</h3>
<p>GANçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œåˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ä¹‹é—´çš„å¯¹æŠ—è®­ç»ƒæ¥å­¦ä¹ æ•°æ®åˆ†å¸ƒï¼š</p>
<ul>
<li><strong>ç”Ÿæˆå™¨G</strong>ï¼šå­¦ä¹ çœŸå®æ•°æ®åˆ†å¸ƒï¼Œç”Ÿæˆé€¼çœŸçš„å‡æ ·æœ¬</li>
<li><strong>åˆ¤åˆ«å™¨D</strong>ï¼šåŒºåˆ†çœŸå®æ ·æœ¬å’Œç”Ÿæˆæ ·æœ¬</li>
<li><strong>å¯¹æŠ—è¿‡ç¨‹</strong>ï¼šç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨ï¼Œåˆ¤åˆ«å™¨è¯•å›¾æ­£ç¡®è¯†åˆ«</li>
</ul>
<h3 id="æ•°å­¦åŸºç¡€">æ•°å­¦åŸºç¡€</h3>
<p><strong>ç”Ÿæˆå™¨ç›®æ ‡</strong>ï¼š
$$\min_G \max_D V(D,G) = \mathbb{E}<em>{x \sim p</em>{data}}[\log D(x)] + \mathbb{E}_{z \sim p_z}[\log (1 - D(G(z)))]$$</p>
<p><strong>æœ€ä¼˜åˆ¤åˆ«å™¨</strong>ï¼š
$$D^*(x) = \frac{p_{data}(x)}{p_{data}(x) + p_g(x)}$$</p>
<h2 id="-ganæ¶æ„è¯¦è§£">ğŸ—ï¸ GANæ¶æ„è¯¦è§£</h2>
<h3 id="ç”Ÿæˆå™¨ç»“æ„">ç”Ÿæˆå™¨ç»“æ„</h3>
<p>ç”Ÿæˆå™¨é€šå¸¸é‡‡ç”¨è§£ç å™¨å¼çš„æ¶æ„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Generator</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, latent_dim, img_shape):
</span></span><span style="display:flex;"><span>        super(Generator, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>model <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Sequential(
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(latent_dim, <span style="color:#ae81ff">128</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">128</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">256</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">256</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç¬¬ä¸‰ä¸ªå…¨è¿æ¥å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">512</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">512</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># è¾“å‡ºå±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">512</span>, int(np<span style="color:#f92672">.</span>prod(img_shape))),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Tanh()
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, z):
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>model(z)
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>view(img<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), <span style="color:#f92672">*</span>img_shape)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> img
</span></span></code></pre></div><h3 id="åˆ¤åˆ«å™¨ç»“æ„">åˆ¤åˆ«å™¨ç»“æ„</h3>
<p>åˆ¤åˆ«å™¨é‡‡ç”¨åˆ†ç±»å™¨æ¶æ„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Discriminator</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, img_shape):
</span></span><span style="display:flex;"><span>        super(Discriminator, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>model <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Sequential(
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç¬¬ä¸€ä¸ªå·ç§¯å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Conv2d(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">64</span>, kernel_size<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, stride<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, padding<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm2d(<span style="color:#ae81ff">64</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>LeakyReLU(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç¬¬äºŒä¸ªå·ç§¯å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Conv2d(<span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">128</span>, kernel_size<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, stride<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, padding<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm2d(<span style="color:#ae81ff">128</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>LeakyReLU(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># å…¨å±€å¹³å‡æ± åŒ–</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>AdaptiveAvgPool2d(<span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># å…¨è¿æ¥å±‚</span>
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Sigmoid()
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, img):
</span></span><span style="display:flex;"><span>        validity <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>model(img)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> validity
</span></span></code></pre></div><h2 id="-è®­ç»ƒç®—æ³•">ğŸš€ è®­ç»ƒç®—æ³•</h2>
<h3 id="æ ‡å‡†ganè®­ç»ƒ">æ ‡å‡†GANè®­ç»ƒ</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">train_gan</span>(generator, discriminator, dataloader, num_epochs, latent_dim):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># æŸå¤±å‡½æ•°</span>
</span></span><span style="display:flex;"><span>    adversarial_loss <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>BCELoss()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ä¼˜åŒ–å™¨</span>
</span></span><span style="display:flex;"><span>    optimizer_G <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>optim<span style="color:#f92672">.</span>Adam(generator<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0002</span>, betas<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.999</span>))
</span></span><span style="display:flex;"><span>    optimizer_D <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>optim<span style="color:#f92672">.</span>Adam(discriminator<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0002</span>, betas<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.999</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(num_epochs):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i, (real_imgs, _) <span style="color:#f92672">in</span> enumerate(dataloader):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># çœŸå®å›¾åƒæ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>            valid <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>ones(real_imgs<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), <span style="color:#ae81ff">1</span>, requires_grad<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>            fake <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>zeros(real_imgs<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), <span style="color:#ae81ff">1</span>, requires_grad<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># è®­ç»ƒåˆ¤åˆ«å™¨</span>
</span></span><span style="display:flex;"><span>            optimizer_D<span style="color:#f92672">.</span>zero_grad()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># åˆ¤åˆ«å™¨å¯¹çœŸå®å›¾åƒçš„é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>            real_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(real_imgs), valid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç”Ÿæˆå‡å›¾åƒ</span>
</span></span><span style="display:flex;"><span>            z <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>randn(real_imgs<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), latent_dim)
</span></span><span style="display:flex;"><span>            fake_imgs <span style="color:#f92672">=</span> generator(z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># åˆ¤åˆ«å™¨å¯¹å‡å›¾åƒçš„é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>            fake_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(fake_imgs<span style="color:#f92672">.</span>detach()), fake)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># åˆ¤åˆ«å™¨æ€»æŸå¤±</span>
</span></span><span style="display:flex;"><span>            d_loss <span style="color:#f92672">=</span> (real_loss <span style="color:#f92672">+</span> fake_loss) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>            d_loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>            optimizer_D<span style="color:#f92672">.</span>step()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># è®­ç»ƒç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span>            optimizer_G<span style="color:#f92672">.</span>zero_grad()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨</span>
</span></span><span style="display:flex;"><span>            g_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(fake_imgs), valid)
</span></span><span style="display:flex;"><span>            g_loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>            optimizer_G<span style="color:#f92672">.</span>step()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Epoch </span><span style="color:#e6db74">{</span>epoch<span style="color:#e6db74">}</span><span style="color:#e6db74">: D_loss: </span><span style="color:#e6db74">{</span>d_loss<span style="color:#f92672">.</span>item()<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, G_loss: </span><span style="color:#e6db74">{</span>g_loss<span style="color:#f92672">.</span>item()<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="-ganå˜ç§">ğŸ¨ GANå˜ç§</h2>
<h3 id="dcgan-deep-convolutional-gan">DCGAN (Deep Convolutional GAN)</h3>
<ul>
<li><strong>å·ç§¯æ¶æ„</strong>ï¼šä½¿ç”¨å·ç§¯å±‚æ›¿ä»£å…¨è¿æ¥å±‚</li>
<li><strong>æ‰¹å½’ä¸€åŒ–</strong>ï¼šç¨³å®šè®­ç»ƒè¿‡ç¨‹</li>
<li><strong>æ”¹è¿›æ¿€æ´»</strong>ï¼šç”Ÿæˆå™¨ä½¿ç”¨ReLUï¼Œåˆ¤åˆ«å™¨ä½¿ç”¨LeakyReLU</li>
</ul>
<h3 id="wgan-wasserstein-gan">WGAN (Wasserstein GAN)</h3>
<ul>
<li><strong>Wassersteinè·ç¦»</strong>ï¼šæ›´ç¨³å®šçš„è®­ç»ƒç›®æ ‡</li>
<li><strong>æƒé‡è£å‰ª</strong>ï¼šé™åˆ¶åˆ¤åˆ«å™¨æƒé‡èŒƒå›´</li>
<li><strong>ç†è®ºä¿è¯</strong>ï¼šé¿å…æ¨¡å¼å´©æºƒ</li>
</ul>
<h3 id="cyclegan">CycleGAN</h3>
<ul>
<li><strong>æ— é…å¯¹æ•°æ®</strong>ï¼šå­¦ä¹ ä¸åŒåŸŸä¹‹é—´çš„æ˜ å°„</li>
<li><strong>å¾ªç¯ä¸€è‡´æ€§</strong>ï¼šç¡®ä¿è½¬æ¢çš„å¯é€†æ€§</li>
<li><strong>åº”ç”¨</strong>ï¼šå›¾åƒé£æ ¼è¿ç§»</li>
</ul>
<h3 id="stylegan">StyleGAN</h3>
<ul>
<li><strong>é£æ ¼æ§åˆ¶</strong>ï¼šé€šè¿‡AdaINæ§åˆ¶ç”Ÿæˆå›¾åƒçš„é£æ ¼</li>
<li><strong>æ¸è¿›å¼å¢é•¿</strong>ï¼šä»ä½åˆ†è¾¨ç‡åˆ°é«˜åˆ†è¾¨ç‡è®­ç»ƒ</li>
<li><strong>é«˜è´¨é‡ç”Ÿæˆ</strong>ï¼šç”Ÿæˆé«˜åˆ†è¾¨ç‡é€¼çœŸå›¾åƒ</li>
</ul>
<h2 id="-æŸå¤±å‡½æ•°">ğŸ¯ æŸå¤±å‡½æ•°</h2>
<h3 id="æ ‡å‡†ganæŸå¤±">æ ‡å‡†GANæŸå¤±</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># åˆ¤åˆ«å™¨æŸå¤±</span>
</span></span><span style="display:flex;"><span>d_real_loss <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>torch<span style="color:#f92672">.</span>log(discriminator(real_imgs))
</span></span><span style="display:flex;"><span>d_fake_loss <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>torch<span style="color:#f92672">.</span>log(<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> discriminator(fake_imgs))
</span></span><span style="display:flex;"><span>d_loss <span style="color:#f92672">=</span> (d_real_loss <span style="color:#f92672">+</span> d_fake_loss) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆå™¨æŸå¤±</span>
</span></span><span style="display:flex;"><span>g_loss <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>torch<span style="color:#f92672">.</span>log(discriminator(fake_imgs))
</span></span></code></pre></div><h3 id="wganæŸå¤±">WGANæŸå¤±</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># WGANä½¿ç”¨Wassersteinè·ç¦»</span>
</span></span><span style="display:flex;"><span>d_loss <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>torch<span style="color:#f92672">.</span>mean(discriminator(real_imgs)) <span style="color:#f92672">+</span> torch<span style="color:#f92672">.</span>mean(discriminator(fake_imgs))
</span></span><span style="display:flex;"><span>g_loss <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>torch<span style="color:#f92672">.</span>mean(discriminator(fake_imgs))
</span></span></code></pre></div><h3 id="lsganæŸå¤±">LSGANæŸå¤±</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># æœ€å°äºŒä¹˜GAN</span>
</span></span><span style="display:flex;"><span>d_real_loss <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>mean((discriminator(real_imgs) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>d_fake_loss <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>mean(discriminator(fake_imgs)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>d_loss <span style="color:#f92672">=</span> (d_real_loss <span style="color:#f92672">+</span> d_fake_loss) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g_loss <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>mean((discriminator(fake_imgs) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><h2 id="-è®­ç»ƒæŠ€å·§">ğŸ”§ è®­ç»ƒæŠ€å·§</h2>
<h3 id="æ¨¡å¼å´©æºƒé—®é¢˜">æ¨¡å¼å´©æºƒé—®é¢˜</h3>
<p><strong>é—®é¢˜</strong>ï¼šç”Ÿæˆå™¨åªç”Ÿæˆæœ‰é™çš„æ ·æœ¬æ¨¡å¼</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>Mini-batchåˆ¤åˆ«</strong>ï¼šåˆ¤åˆ«å™¨ä½¿ç”¨å¤šä¸ªå‡æ ·æœ¬</li>
<li><strong>ç‰¹å¾åŒ¹é…</strong>ï¼šåŒ¹é…çœŸå®å’Œç”Ÿæˆæ•°æ®çš„ä¸­é—´ç‰¹å¾</li>
<li><strong>è°±å½’ä¸€åŒ–</strong>ï¼šç¨³å®šåˆ¤åˆ«å™¨è®­ç»ƒ</li>
</ul>
<h3 id="æ¢¯åº¦æ¶ˆå¤±é—®é¢˜">æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h3>
<p><strong>é—®é¢˜</strong>ï¼šåˆ¤åˆ«å™¨è¿‡å¼ºå¯¼è‡´ç”Ÿæˆå™¨æ¢¯åº¦æ¶ˆå¤±</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>æ ‡ç­¾å¹³æ»‘</strong>ï¼šä½¿ç”¨0.9ä»£æ›¿1.0ä½œä¸ºçœŸå®æ ‡ç­¾</li>
<li><strong>å†å²å¹³å‡</strong>ï¼šä¿å­˜åˆ¤åˆ«å™¨çš„å†å²ç‰ˆæœ¬</li>
<li><strong>é¢‘ç‡åˆ†ç¦»</strong>ï¼šåˆ†ç¦»é«˜é¢‘å’Œä½é¢‘ä¿¡æ¯</li>
</ul>
<h2 id="-åº”ç”¨é¢†åŸŸ">ğŸ¨ åº”ç”¨é¢†åŸŸ</h2>
<h3 id="å›¾åƒç”Ÿæˆ">å›¾åƒç”Ÿæˆ</h3>
<ul>
<li><strong>äººè„¸ç”Ÿæˆ</strong>ï¼šStyleGANç”Ÿæˆé€¼çœŸçš„äººè„¸å›¾åƒ</li>
<li><strong>è‰ºæœ¯åˆ›ä½œ</strong>ï¼šç”Ÿæˆå„ç§é£æ ¼çš„è‰ºæœ¯ä½œå“</li>
<li><strong>æ•°æ®å¢å¼º</strong>ï¼šä¸ºè®­ç»ƒæ•°æ®ç”Ÿæˆæ›´å¤šæ ·æœ¬</li>
</ul>
<h3 id="å›¾åƒåˆ°å›¾åƒè½¬æ¢">å›¾åƒåˆ°å›¾åƒè½¬æ¢</h3>
<ul>
<li><strong>é£æ ¼è¿ç§»</strong>ï¼šå°†å›¾åƒè½¬æ¢ä¸ºä¸åŒè‰ºæœ¯é£æ ¼</li>
<li><strong>è¶…åˆ†è¾¨ç‡</strong>ï¼šå°†ä½åˆ†è¾¨ç‡å›¾åƒè½¬æ¢ä¸ºé«˜åˆ†è¾¨ç‡</li>
<li><strong>å›¾åƒä¿®å¤</strong>ï¼šä¿®å¤æŸåæˆ–ç¼ºå¤±çš„å›¾åƒéƒ¨åˆ†</li>
</ul>
<h3 id="æ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆ">æ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆ</h3>
<ul>
<li><strong>DALL-E</strong>ï¼šæ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆå›¾åƒ</li>
<li><strong>Stable Diffusion</strong>ï¼šé«˜æ•ˆçš„æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹</li>
<li><strong>Midjourney</strong>ï¼šå•†ä¸šçº§å›¾åƒç”ŸæˆæœåŠ¡</li>
</ul>
<h3 id="è§†é¢‘ç”Ÿæˆ">è§†é¢‘ç”Ÿæˆ</h3>
<ul>
<li><strong>è§†é¢‘é¢„æµ‹</strong>ï¼šé¢„æµ‹è§†é¢‘åºåˆ—çš„ä¸‹ä¸€å¸§</li>
<li><strong>è§†é¢‘åˆæˆ</strong>ï¼šç”Ÿæˆæ–°çš„è§†é¢‘å†…å®¹</li>
<li><strong>åŠ¨ä½œè¿ç§»</strong>ï¼šå°†åŠ¨ä½œä»ä¸€ä¸ªè§†é¢‘è¿ç§»åˆ°å¦ä¸€ä¸ª</li>
</ul>
<h2 id="-è¯„ä¼°æŒ‡æ ‡">ğŸ“Š è¯„ä¼°æŒ‡æ ‡</h2>
<h3 id="å®šé‡è¯„ä¼°">å®šé‡è¯„ä¼°</h3>
<ul>
<li><strong>Inception Score (IS)</strong>ï¼šè¯„ä¼°ç”Ÿæˆå›¾åƒçš„è´¨é‡å’Œå¤šæ ·æ€§</li>
<li><strong>FrÃ©chet Inception Distance (FID)</strong>ï¼šè®¡ç®—ç”Ÿæˆæ•°æ®ä¸çœŸå®æ•°æ®çš„è·ç¦»</li>
<li><strong>Kernel Inception Distance (KID)</strong>ï¼šæ”¹è¿›çš„FIDæŒ‡æ ‡</li>
</ul>
<h3 id="å®šæ€§è¯„ä¼°">å®šæ€§è¯„ä¼°</h3>
<ul>
<li><strong>ç”¨æˆ·ç ”ç©¶</strong>ï¼šäººç±»è¯„ä¼°ç”Ÿæˆå›¾åƒçš„è´¨é‡</li>
<li><strong>å¤šæ ·æ€§åˆ†æ</strong>ï¼šåˆ†æç”Ÿæˆæ ·æœ¬çš„å¤šæ ·æ€§</li>
<li><strong>æ’å€¼å®éªŒ</strong>ï¼šæµ‹è¯•æ½œåœ¨ç©ºé—´çš„è¿ç»­æ€§</li>
</ul>
<h2 id="-ç¼–ç¨‹å®ç°">ğŸš€ ç¼–ç¨‹å®ç°</h2>
<h3 id="å®Œæ•´ganè®­ç»ƒä»£ç ">å®Œæ•´GANè®­ç»ƒä»£ç </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> torch.nn <span style="color:#66d9ef">as</span> nn
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> torch.optim <span style="color:#66d9ef">as</span> optim
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> torchvision <span style="color:#f92672">import</span> datasets, transforms
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> torch.utils.data <span style="color:#f92672">import</span> DataLoader
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æ•°æ®é¢„å¤„ç†</span>
</span></span><span style="display:flex;"><span>transform <span style="color:#f92672">=</span> transforms<span style="color:#f92672">.</span>Compose([
</span></span><span style="display:flex;"><span>    transforms<span style="color:#f92672">.</span>ToTensor(),
</span></span><span style="display:flex;"><span>    transforms<span style="color:#f92672">.</span>Normalize([<span style="color:#ae81ff">0.5</span>], [<span style="color:#ae81ff">0.5</span>])
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åŠ è½½MNISTæ•°æ®é›†</span>
</span></span><span style="display:flex;"><span>dataset <span style="color:#f92672">=</span> datasets<span style="color:#f92672">.</span>MNIST(root<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;./data&#39;</span>, train<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, transform<span style="color:#f92672">=</span>transform, download<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>dataloader <span style="color:#f92672">=</span> DataLoader(dataset, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è¶…å‚æ•°</span>
</span></span><span style="display:flex;"><span>latent_dim <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>img_shape <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">28</span>)
</span></span><span style="display:flex;"><span>num_epochs <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Generator</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        super(Generator, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>model <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Sequential(
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(latent_dim, <span style="color:#ae81ff">128</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">128</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">256</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">256</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">512</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>BatchNorm1d(<span style="color:#ae81ff">512</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>ReLU(),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">512</span>, int(torch<span style="color:#f92672">.</span>prod(torch<span style="color:#f92672">.</span>tensor(img_shape)))),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Tanh()
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, z):
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>model(z)
</span></span><span style="display:flex;"><span>        img <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>view(img<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), <span style="color:#f92672">*</span>img_shape)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> img
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆ¤åˆ«å™¨</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Discriminator</span>(nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        super(Discriminator, self)<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>model <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>Sequential(
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(int(torch<span style="color:#f92672">.</span>prod(torch<span style="color:#f92672">.</span>tensor(img_shape))), <span style="color:#ae81ff">512</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>LeakyReLU(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">512</span>, <span style="color:#ae81ff">256</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>LeakyReLU(<span style="color:#ae81ff">0.2</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>            nn<span style="color:#f92672">.</span>Sigmoid()
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self, img):
</span></span><span style="display:flex;"><span>        img_flat <span style="color:#f92672">=</span> img<span style="color:#f92672">.</span>view(img<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>), <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        validity <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>model(img_flat)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> validity
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># åˆå§‹åŒ–æ¨¡å‹</span>
</span></span><span style="display:flex;"><span>generator <span style="color:#f92672">=</span> Generator()
</span></span><span style="display:flex;"><span>discriminator <span style="color:#f92672">=</span> Discriminator()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span>
</span></span><span style="display:flex;"><span>adversarial_loss <span style="color:#f92672">=</span> nn<span style="color:#f92672">.</span>BCELoss()
</span></span><span style="display:flex;"><span>optimizer_G <span style="color:#f92672">=</span> optim<span style="color:#f92672">.</span>Adam(generator<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0002</span>, betas<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.999</span>))
</span></span><span style="display:flex;"><span>optimizer_D <span style="color:#f92672">=</span> optim<span style="color:#f92672">.</span>Adam(discriminator<span style="color:#f92672">.</span>parameters(), lr<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0002</span>, betas<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.999</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># è®­ç»ƒå¾ªç¯</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> epoch <span style="color:#f92672">in</span> range(num_epochs):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, (real_imgs, _) <span style="color:#f92672">in</span> enumerate(dataloader):
</span></span><span style="display:flex;"><span>        batch_size <span style="color:#f92672">=</span> real_imgs<span style="color:#f92672">.</span>size(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># çœŸå®å’Œå‡æ ‡ç­¾</span>
</span></span><span style="display:flex;"><span>        valid <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>ones(batch_size, <span style="color:#ae81ff">1</span>, requires_grad<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>        fake <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>zeros(batch_size, <span style="color:#ae81ff">1</span>, requires_grad<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è®­ç»ƒåˆ¤åˆ«å™¨</span>
</span></span><span style="display:flex;"><span>        optimizer_D<span style="color:#f92672">.</span>zero_grad()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åˆ¤åˆ«å™¨å¯¹çœŸå®å›¾åƒçš„é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>        real_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(real_imgs), valid)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ç”Ÿæˆå‡å›¾åƒ</span>
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>randn(batch_size, latent_dim)
</span></span><span style="display:flex;"><span>        fake_imgs <span style="color:#f92672">=</span> generator(z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åˆ¤åˆ«å™¨å¯¹å‡å›¾åƒçš„é¢„æµ‹</span>
</span></span><span style="display:flex;"><span>        fake_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(fake_imgs<span style="color:#f92672">.</span>detach()), fake)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åˆ¤åˆ«å™¨æ€»æŸå¤±</span>
</span></span><span style="display:flex;"><span>        d_loss <span style="color:#f92672">=</span> (real_loss <span style="color:#f92672">+</span> fake_loss) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        d_loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>        optimizer_D<span style="color:#f92672">.</span>step()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è®­ç»ƒç”Ÿæˆå™¨</span>
</span></span><span style="display:flex;"><span>        optimizer_G<span style="color:#f92672">.</span>zero_grad()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ç”Ÿæˆå™¨è¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨</span>
</span></span><span style="display:flex;"><span>        g_loss <span style="color:#f92672">=</span> adversarial_loss(discriminator(fake_imgs), valid)
</span></span><span style="display:flex;"><span>        g_loss<span style="color:#f92672">.</span>backward()
</span></span><span style="display:flex;"><span>        optimizer_G<span style="color:#f92672">.</span>step()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Epoch </span><span style="color:#e6db74">{</span>epoch<span style="color:#e6db74">}</span><span style="color:#e6db74">: D_loss: </span><span style="color:#e6db74">{</span>d_loss<span style="color:#f92672">.</span>item()<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, G_loss: </span><span style="color:#e6db74">{</span>g_loss<span style="color:#f92672">.</span>item()<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;è®­ç»ƒå®Œæˆï¼&#34;</span>)
</span></span></code></pre></div><h2 id="-ç”Ÿæˆæ ·æœ¬å¯è§†åŒ–">ğŸ¯ ç”Ÿæˆæ ·æœ¬å¯è§†åŒ–</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_samples</span>(generator, num_samples<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;ç”Ÿæˆå¹¶å¯è§†åŒ–æ ·æœ¬&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    generator<span style="color:#f92672">.</span>eval()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> torch<span style="color:#f92672">.</span>no_grad():
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ç”Ÿæˆéšæœºå™ªå£°</span>
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>randn(num_samples, latent_dim)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ç”Ÿæˆå›¾åƒ</span>
</span></span><span style="display:flex;"><span>        fake_imgs <span style="color:#f92672">=</span> generator(z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># è½¬æ¢ä¸ºnumpyæ•°ç»„ç”¨äºæ˜¾ç¤º</span>
</span></span><span style="display:flex;"><span>        fake_imgs <span style="color:#f92672">=</span> fake_imgs<span style="color:#f92672">.</span>detach()<span style="color:#f92672">.</span>numpy()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># åˆ›å»ºå›¾åƒç½‘æ ¼</span>
</span></span><span style="display:flex;"><span>        fig, axes <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i, ax <span style="color:#f92672">in</span> enumerate(axes<span style="color:#f92672">.</span>flat):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;</span> num_samples:
</span></span><span style="display:flex;"><span>                ax<span style="color:#f92672">.</span>imshow(fake_imgs[i, <span style="color:#ae81ff">0</span>], cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
</span></span><span style="display:flex;"><span>                ax<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#39;off&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ç”Ÿæˆæ ·æœ¬</span>
</span></span><span style="display:flex;"><span>generate_samples(generator)
</span></span></code></pre></div><h2 id="-å­¦ä¹ èµ„æº">ğŸ“š å­¦ä¹ èµ„æº</h2>
<h3 id="ç»å…¸è®ºæ–‡">ç»å…¸è®ºæ–‡</h3>
<ul>
<li><a href="https://arxiv.org/abs/1406.2661">Generative Adversarial Nets</a> - Ian Goodfellow (2014)</li>
<li><a href="https://arxiv.org/abs/1511.06434">Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks</a> - DCGAN</li>
<li><a href="https://arxiv.org/abs/1701.07875">Wasserstein GAN</a> - WGAN</li>
<li><a href="https://arxiv.org/abs/1703.10593">CycleGAN</a> - CycleGAN</li>
</ul>
<h3 id="åœ¨çº¿èµ„æº">åœ¨çº¿èµ„æº</h3>
<ul>
<li><a href="https://www.tensorflow.org/tutorials/generative/dcgan">GANæ•™ç¨‹</a></li>
<li><a href="https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html">PyTorch GANå®ç°</a></li>
<li><a href="https://github.com/hindupuravinash/the-gan-zoo">GAN Zoo</a> - å„ç§GANå˜ç§çš„å®ç°</li>
</ul>
<h3 id="å´æ©è¾¾è¯¾ç¨‹">å´æ©è¾¾è¯¾ç¨‹</h3>
<ul>
<li>æ·±åº¦å­¦ä¹ è¯¾ç¨‹ä¸­å…³äºç”Ÿæˆæ¨¡å‹çš„éƒ¨åˆ†</li>
</ul>
<h2 id="-å®ç”¨æŠ€å·§">ğŸ”§ å®ç”¨æŠ€å·§</h2>
<h3 id="è¶…å‚æ•°è°ƒä¼˜">è¶…å‚æ•°è°ƒä¼˜</h3>
<ul>
<li><strong>å­¦ä¹ ç‡</strong>ï¼šç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨é€šå¸¸ä½¿ç”¨ç›¸åŒæˆ–ç›¸è¿‘çš„å­¦ä¹ ç‡</li>
<li><strong>æ‰¹å¤§å°</strong>ï¼šå½±å“è®­ç»ƒç¨³å®šæ€§å’Œç”Ÿæˆè´¨é‡</li>
<li><strong>æ½œåœ¨ç»´åº¦</strong>ï¼šå½±å“ç”Ÿæˆæ ·æœ¬çš„å¤šæ ·æ€§</li>
</ul>
<h3 id="æ¨¡å‹è°ƒè¯•">æ¨¡å‹è°ƒè¯•</h3>
<ul>
<li><strong>ç›‘æ§æŸå¤±</strong>ï¼šåˆ¤åˆ«å™¨å’Œç”Ÿæˆå™¨æŸå¤±åº”è¯¥åœ¨åˆç†èŒƒå›´å†…æ³¢åŠ¨</li>
<li><strong>æ ·æœ¬è´¨é‡</strong>ï¼šå®šæœŸæ£€æŸ¥ç”Ÿæˆæ ·æœ¬çš„è´¨é‡</li>
<li><strong>æ¨¡å¼å´©æºƒæ£€æµ‹</strong>ï¼šç¡®ä¿ç”Ÿæˆæ ·æœ¬å…·æœ‰è¶³å¤Ÿçš„å¤šæ ·æ€§</li>
</ul>
<hr>
<p><em>æœ€è¿‘æ›´æ–°: {{ .Lastmod.Format &ldquo;2006-01-02&rdquo; }}</em></p>

      
      <div class="post-separator">------------------------------------------------------------------------</div>
      
    </div>
    <div class="post-footer">
      
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <div class="busuanzi-container">
        <span id="busuanzi_container_page_pv">--æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡--</span>
      </div>
      
      
      <script src="https://utteranc.es/client.js"
        repo="makkichan947/makkichan947.github.io"
        issue-term="pathname"
        label="Utterances"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
    </div>
  </article>

    </main>
  </body>
</html>
